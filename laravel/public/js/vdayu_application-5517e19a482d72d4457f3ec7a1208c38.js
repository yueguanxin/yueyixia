$(function(){$("body.bonus-body").scrollspy({target:".bonus-navbar"})});$(function(){$(".lazy img").lazyload({threshold:300,effect:"fadeIn"})});
$(function(){Boolean($("#tab-wrapper").length)&&$("#tab-wrapper").affix({offset:{top:$("#tab-wrapper").offset().top}});$('#person_selection a[data-toggle="tab"]').on("shown.bs.tab",function(a){a=$(a.target);a.parent("#person_selection").find(".ptitle__option--active").removeClass("ptitle__option--active");a.find(".ptitle-option").addClass("ptitle__option--active");$(a.attr("href")).find('a[data-toggle="tab"]:first').trigger("click")});$('#pd-content_selection a[data-toggle="tab"]').on("shown.bs.tab",
function(a){a=$(a.target);a.closest("#pd-content_selection").find(".pselection__option--active").removeClass("pselection__option--active");a.closest(".pselection-option").addClass("pselection__option--active")});$("#passport_primary_tour_projects").on("change",function(){var a=$("#tour_project_"+$(this).val()),c=$("#passport_secondary_selection");Boolean(a.data("self-service"))?(c.show(),Boolean($("#passport_secondary_tour_projects").val().length)&&(a=$("#tour_project_"+$("#passport_secondary_tour_projects").val()))):
c.hide();a.siblings(".p-aside-price").hide();a.show();$("#passport_aside_desc").text(a.data("desc"));$("#passport_tour_project_id").val(a.data("id"))});$("#passport_secondary_tour_projects").on("change",function(){$(".p-aside-price em").remove();$("#passport_primary_tour_projects").trigger("change")});$("#passport_buy").on("click",function(){$(this).attr("href",""+$(this).attr("href")+"&rid="+$("#passport_tour_project_id").val());return!0});$("#passport_primary_tour_projects").trigger("change");$(".yicon-passport-tip").tooltip();
$("body").scrollspy({target:".tab-wrapper"})});$(function(){});
$(function(){$(".js-common-contacts").on("click",".jccontacts__btn",function(a){a=$(this).parents(".js-common-contacts-wrapper");var b=$(this).data("real-name"),d=$(this).data("cellphone"),e=$(this).data("email"),f=$(this).data("wechat"),g=$(this).data("qq");a.find(".real_name").val(b);a.find(".cellphone").val(d);a.find(".email").val(e);a.find(".wechat").val(f);a.find(".qq").val(g);a.find(".first_name").val(String(b).split(" ")[0]);a.find(".last_name").val(String(b).split(" ")[1])});$(".js_order_contracts").on("click",
".tos_cmd, .drawback_cmd, .indemnity_cmd",function(){$(this).popover("toggle")});$("#tos").on("change",function(){$("#tos").attr("checked")?$(".oform-sumbit__submit").removeClass("disabled"):$(".oform-sumbit__submit").addClass("disabled")});$(".js_payment_selection").on({click:function(){active_class="ps__service-action--active";$(this).siblings(".js_payment_selection_action").removeClass(active_class);$(this).addClass(active_class);$(".js_order_overview").data("service",$(this).data("service"))}},
".js_payment_selection_action");$(".js_payment_selection").on({change:function(){$(".js_order_overview").data("invoice",$(this).prop("checked"))}},".js_payment_selection_invoice");$(".js_order_overview").on({click:function(){window.open($(".js_order_overview").data("pay-url")+"&yu_pay="+$(".js_order_overview").data("service")+"&invoice="+$(".js_order_overview").data("invoice"))}},".js_order_payment_checkout");$(".js_specific_order_adult_number_select").on("change",function(){var a=$(this).parents(".js_order_attendences_number"),
b=parseInt($(this).val())||0,b=parseInt($("#max_person").val())+2-b,a=a.find(".js_specific_order_children_number_select"),d=a.val();a.find("option").remove();for(var e=0;e<=b;e++)a.append("<option value="+e+">"+e+"</option>");0!=a.find("option[value='"+d+"']").length?a.find("option[value='"+d+"']").attr("selected","selected"):a.find("option").last().attr("selected","selected");a.trigger("change")});$(".js_specific_order_children_number_select").on("change",function(){var c=$(this).parents(".js_order_attendences_number"),
b=parseInt($(this).val());0<b?$(".js_children_age_label").show():$(".js_children_age_label").hide();var c=parseInt(c.find(".js_specific_order_adult_number_select").val())||0,d=parseInt($("#max_person").val()),e=$(this).data("append-target");a(b,e);b=c+b-d;0<b?$(".js_excess_max_limit_tips").html("\u60a8\u7684\u5165\u4f4f\u4eba\u6570\u8d85\u8fc7\u4e86 "+b+" \u4eba\uff0c\u53ef\u80fd\u4ea7\u751f\u52a0\u4eba\u6216\u52a0\u5e8a\u8d39\u7528").show():$(".js_excess_max_limit_tips").hide()});$(".js_specific_order_children_number_input").on("blur",
function(){var c=parseInt($(this).val()),b=$(this).data("append-target");a(c,b)});var a=function(a,b){var d=$(b).children(".js_specific_order_children_age_group").size();0==a?$(b).children(".js_specific_order_children_age_group").remove():d>a&&$(b).children(".js_specific_order_children_age_group:gt("+(a-1)+")").remove();for(var e="<option value>\u8bf7\u9009\u62e9\u771f\u5b9e\u513f\u7ae5\u5e74\u9f84</option>",f=1;13>f;f++)e+="<option value='{0}'>{0}</option>".parseTpl(f);for(;d<a;d++){var f="\u7b2c"+
(d+1)+"\u4f4d",g=$(b).data("specific-name");$(b).append("<div class='yu-form__group js_specific_order_children_age_group'><span class='fsection__tips'>{0}</span><div class='yu-form__control'><select name='{1}[children_ages][]' class='form-control person-number__select required'>{2}</select></div></div>".parseTpl(f,g,e))}};(new DailyDiscountCountdown({elements:$(".js-home-daily-countdown"),need_refresh:!1,finished:function(a){a.parent().html("\u7279\u60e0\u5df2\u7ed3\u675f! ").addClass("daily-discount-time--sell-out")},
refresh:function(){}})).start();$(".js_discount_flash_tooltip").tooltip({html:!0,trigger:"hover"});$(".js-daily-discount-failed-modal-button").on("click",function(a){$(".js-daily-discount-faild-modal").modal("hide");location.reload()});$(".js-house-order-submit").on("click",function(a){0<$(".daily-discount-time").length&&(house_id=$(this).data("house-id"),$.ajax({url:"/house_orders/check_house_daily_discount",type:"POST",data:{house_id:house_id}}).then(function(a){"success"==a.status&&a.is_valid?
$(".js-new-house-order").submit():($(".js-daily-discount-faild-content").html(a.failed_content),$(".js-daily-discount-faild-modal").modal("show"))}),a.preventDefault())})});var houseOrderInit=function(){$(".js_specific_order_children_number_select").trigger("change")};
window.OrderPaying={checkIntervalId:0,checkLimit:60,checkTime:0,init:function(a){this.order_id=a;clearInterval(this.checkIntervalId);this.checkIntervalId=setInterval(function(a){return function(b){a.checkTime>=a.checkLimit||($.ajax({url:"/orders/"+a.order_id+"/pay_status.json",dataType:"json",type:"GET",success:function(a,b,c){"success"==a.status&&(window.location="/orders/my")}}),a.checkTime+=1)}}(this),5E3)}};
$(function(){$(".js_house_show").scrollspy({target:".js_house_show_tab_nav"});$(window).load(function(){if(!Boolean($(".js_house_show").length))return!1;$("body").scrollspy("refresh");0<window.location.hash.length&&$(document).scrollTo(window.location.hash);0<$(document).scrollTop()&&$(".js_house_show_scroll_top").fadeIn();$(window).on("scroll",function(){if(!Boolean($(".js_house_show").length))return!1;var a=$(document).scrollTop();0<a?$(".js_house_show_scroll_top").fadeIn():$(".js_house_show_scroll_top").fadeOut();
a>$(".js_house_show_banner").height()?$(".js_house_show_tab_nav").fadeIn():$(".js_house_show_tab_nav").fadeOut();return!0})});var a=function(){var a=$(".js_hphotos_thumb_item_active"),b=($(".js_house_photos_thumb .slick-list").offset().left-$(".js_house_photos_thumb .slick-track").offset().left)%$(".js_hphotos_thumb_item").width();a.is($(".js_house_photos_thumb .slick-active:first"))?0!=b&&$(".js_house_photos_thumb .slick-track").animate({left:"0px"},300):a.is($(".js_house_photos_thumb .slick-active:last"))&&
0==b&&(a=$(".js_house_photos_thumb").width()-7*$(".js_hphotos_thumb_item").width()-$(".js_hphotos_thumb_item img").width(),$(".js_house_photos_thumb .slick-track").animate({left:a+"px"},300))};$(".js_house_photos_list").slick({accessibility:!1,autoplay:!1,draggable:!1,arrows:!1,infinite:!1,slideSpeed:300,onAfterChange:function(b,c){1024<$(document).width()&&($(".js_hphotos_list_item:last").hasClass("slick-active")?$(".js_house_photos_list_next").hide():$(".js_hphotos_list_item:first").hasClass("slick-active")?
$(".js_house_photos_list_prev").hide():($(".js_house_photos_list_next").show(),$(".js_house_photos_list_prev").show()));var d=$(".js_house_show_photos").data("from");if(null!=d&&null!=c){var e=$(".js_hphotos_thumb_item:eq("+d+")"),f=$(".js_hphotos_thumb_item:eq("+c+")");e.removeClass("js_hphotos_thumb_item_active hphotos__thumb-item--active");f.addClass("js_hphotos_thumb_item_active hphotos__thumb-item--active");f.hasClass("slick-active")||$(".js_house_photos_thumb").slickGoTo(f.index());a();d>c?
f.hasClass("slick-active")||$(".js_house_photos_thumb").slickPrev():d<c&&(f.hasClass("slick-active")||$(".js_house_photos_thumb").slickNext())}}});$(".js_house_photos_thumb").slick({accessibility:!1,autoplay:!1,draggable:!1,arrows:!1,infinite:!1,slideSpeed:300,slidesToShow:8,slidesToScroll:1,onAfterChange:function(){a()}});var c=function(a){var b=$(".js_house_photos_thumb .js_hphotos_thumb_item_active");if("next"==a)$(".js_house_photos_list").slickNext();else if("prev"==a)$(".js_house_photos_list").slickPrev();
else return!1;$(".js_house_show_photos").data("from",b.index());return!0};$(".js_house_show_photos").on({click:function(){c("prev")}},".js_house_photos_list_prev");$(".js_house_show_photos").on({click:function(){c("next")}},".js_house_photos_list_next");$(".js_house_show_photos").on({click:function(){$(".js_house_photos_thumb").slickPrev()}},".js_house_photos_thumb_prev");$(".js_house_show_photos").on({click:function(){$(".js_house_photos_thumb").slickNext()}},".js_house_photos_thumb_next");$(".js_house_show_photos").on({click:function(){$(".js_house_show_photos").data("from",
$(".js_hphotos_thumb_item_active").index());$(".js_house_photos_list").slickGoTo($(this).index())}},".js_hphotos_thumb_item");$(".js_house_show").on({click:function(){$(document).scrollTo($(".js_house_show_date_select"),300)}},".js_house_show_to_rooms");var b=function(){$form=$(".js_house_show_date_select form");if($form.hasClass("disabled"))return!1;$.ajax({url:$(this).attr("action"),data:$form.serialize(),dataType:"json",type:"GET",context:this,beforeSend:function(){$form.addClass("disabled")},
complete:function(){$form.removeClass("disabled")},success:function(a){"success"==a.status&&($(".js_house_show_rooms_list").replaceWith(a.room_list),$(".js_house_show_min_price").html(a.house_price),$(".js_house_show_policy").html(a.drawback_policy),$(".js_house_show_loading").hide(),$(".js_house_show_submit_query").removeAttr("disabled"),m())}})};$(".js_house_show_date_select").datepicker_pairs({first_picker_class:"js_house_show_datepicker_checkin",second_picker_class:"js_house_show_datepicker_checkout",
second_picker_is_behind_a_day:!0});$(".js_house_show_submit_query").on("click",function(a){if(0==$(".js_house_show_datepicker_checkin").val().length)return $(".js_house_show_datepicker_checkin").focus(),!1;if(0==$(".js_house_show_datepicker_checkout").val().length)return $(".js_house_show_datepicker_checkout").focus(),!1;b();$(".js_house_show_loading").show();$(".js_house_show_submit_query").attr("disabled","disabled")});var d="\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("");$(".js_house_show_datepicker_input").datepicker().on("changeDate",
function(a){a="\uff08\u661f\u671f"+d[a.date.getDay()]+"\uff09";$(this).siblings(".js_house_show_datepicker_weekday").text(a)});$(".js_house_show_datepicker_weekday, .js_house_show_datepicker_calender").on("click",function(){$(this).prevAll(".js_house_show_datepicker_input").trigger("focus")});$(".js_house_show").on({click:function(){$(document).scrollTo(0,300)}},".js_house_show_scroll_top");$(".js_house_show").on({click:function(){if($(this).hasClass("disabled"))return!1;if(0==$(".js_house_show_datepicker_checkin").val().length)return $(document).scrollTo($(".js_house_show_date_select"),
300),$(".js_house_show_datepicker_checkin").focus(),!1;if(0==$(".js_house_show_datepicker_checkout").val().length)return $(document).scrollTo($(".js_house_show_date_select"),300),$(".js_house_show_datepicker_checkout").focus(),!1;$.ajax({url:$(this).data("url"),data:{start_day:$(".js_house_show_datepicker_checkin").val(),end_day:$(".js_house_show_datepicker_checkout").val()},dataType:"json",type:"GET",context:this,beforeSend:function(){$(this).addClass("disabled");$(".js_room_detail_modal").remove()},
complete:function(){$(this).removeClass("disabled")},success:function(a){"success"==a.status&&($(".js_house_show").append(a.html),$(".js_room_detail_modal").modal("show"),setTimeout(e,300),$(".js_room_detail_modal_bill").datepicker_pairs({first_picker_class:"js_room_detail_modal_bill_checkin",second_picker_class:"js_room_detail_modal_bill_checkout",callback:g}))}})}},".js_house_show_room_item");var e=function(){$(".js_rome_detail_photos_list").slick({accessibility:!1,autoplay:!1,draggable:!1,arrows:!1,
infinite:!1,slideSpeed:300,onInit:function(){$(".js_rome_detail_photos_item").fadeIn()},onAfterChange:function(a,b){$(".js_rome_detail_photos_item:last").hasClass("slick-active")?($(".js_rome_detail_photo_list_prev").show(),$(".js_rome_detail_photo_list_next").hide()):($(".js_rome_detail_photos_item:first").hasClass("slick-active")?$(".js_rome_detail_photo_list_prev").hide():$(".js_rome_detail_photo_list_prev").show(),$(".js_rome_detail_photo_list_next").show())}})},f=function(){var a=$(".js_room_detail_modal_new_order");
if(a.hasClass("disabled"))return!1;$.ajax({url:a.attr("action"),data:a.serialize(),dataType:"json",type:a.attr("method"),context:this,beforeSend:function(){a.addClass("disabled")},complete:function(){a.removeClass("disabled")},success:function(a){"success"==a.status&&$(".js_room_detail_checkout").replaceWith(a.html)}})},g=function(){f();if($(".js_room_detail_modal_calendar").is(":visible")){var a=$(".js_room_detail_modal_calendar").data("url"),b=$("#house_order_start_day").val().split("-");h(a,b[0]+
"-"+b[1])}};$(".js_house_show").on({change:f},".js_room_detail_modal_bill_number");$(".js_house_show").on({click:function(){var a=$(this).siblings(".js_room_detail_modal_bill_number"),b=parseInt(a.val()),c=a.data("min-num");if($(this).hasClass("js_room_detail_modal_control_disable")||b-1<c)return!1;a.val(b-1);a.trigger("change");return!1}},".js_room_detail_modal_minus_number");$(".js_house_show").on({click:function(){var a=$(this).siblings(".js_room_detail_modal_bill_number"),b=parseInt(a.val()),
c=a.data("max-num");if($(this).hasClass("js_room_detail_modal_control_disable")||b+1>c)return!1;a.val(b+1);a.trigger("change");return!1}},".js_room_detail_modal_plus_number");$(".js_house_show").on({change:function(){var a=$(this).siblings(".js_room_detail_modal_plus_number"),b=$(this).siblings(".js_room_detail_modal_minus_number"),c=parseInt($(this).val()),d=parseInt($(this).data("max-num")),e=parseInt($(this).data("min-num"));d>c?a.removeClass("js_room_detail_modal_control_disable rd-modal-bill__number--negative"):
a.addClass("js_room_detail_modal_control_disable rd-modal-bill__number--negative");e<c?b.removeClass("js_room_detail_modal_control_disable rd-modal-bill__number--negative"):b.addClass("js_room_detail_modal_control_disable rd-modal-bill__number--negative");f()}},".js_room_detail_modal_bill_number");$(".js_house_show").on({"shown.bs.tab":function(a){a=$(a.target);a.siblings(".js_room_detail_modal_nav").removeClass("rd-container__option--active");a.addClass("rd-container__option--active")}},'.js_room_detail_modal a[data-toggle="tab"]');
var h=function(a,b){$target=$(".js_room_detail_modal_calendar");if($target.hasClass("disabled"))return!1;$.ajax({url:a,data:{month:b,selected_start_day:$(".js_room_detail_modal_bill_checkin").val(),selected_end_day:$(".js_room_detail_modal_bill_checkout").val()},dataType:"json",type:"GET",context:this,beforeSend:function(){$target.addClass("disabled")},complete:function(){$target.removeClass("disabled")},success:function(a){"success"==a.status&&$target.html(a.html)}})};$(".js_house_show").on({click:function(){if(!Boolean($(".js_room_detail_calendar").length)){var a=
$(".js_room_detail_modal_calendar").data("url"),b=$(".js_room_detail_modal_calendar").data("month");h(a,b)}return!0}},".js_room_detail_modal_nav_calendar");$(".js_house_show").on({click:function(){var a=$(this).data("url"),b=$(this).data("month");h(a,b)}},".js_control_month");$(".js_house_show").on({click:function(){$(".js_rome_detail_photos_list").slickPrev()}},".js_rome_detail_photo_list_prev");$(".js_house_show").on({click:function(){$(".js_rome_detail_photos_list").slickNext()}},".js_rome_detail_photo_list_next");
$(".js_house_show").on({click:function(){$(this).prevAll(".js_room_detail_modal_bill_input").trigger("focus")}},".js_room_detail_modal_bill_calender");$(".js_house_index_datepicker_group").datepicker_pairs({first_picker_class:"house_filter_start_day",second_picker_class:"house_filter_end_day",second_picker_is_behind_a_day:!0,width:"223px"});$(".js_house_index_datepicker_input").datepicker().on("changeDate",function(a){a="\uff08\u661f\u671f"+d[a.date.getDay()]+"\uff09";$(this).siblings(".js_house_index_datepicker_weekday").text(a)});
$(".js_house_index_datepicker_weekday, .js_house_index_datepicker_calender").on("click",function(){$(this).prevAll(".js_house_index_datepicker_input").trigger("focus")});$(".jquery_house_index_city_select").chosen({width:"200px"});$(".js_house_filter_cost_index span").on("click",function(a){a=$(this).data("cost-index");$(".house_filter_cost_index").val(a);$(".js_house_filter_cost_index span").removeClass("active");l();k();$(this).addClass("active")});$(".js_house_filter_comfirm_response span").on("click",
function(a){a=$(this).data("confirm-response");$(".house_filter_confirm_response").val(a);$(".js_house_filter_comfirm_response span").removeClass("active");l();k();$(this).addClass("active")});$(".js_house_filter_landmark span").on("click",function(a){a=$(this).data("landmark-name");$(".house_filter_name").val(a);$(".js_house_filter_landmark span").removeClass("active");l();k();$(this).addClass("active")});$(".js_ng_house_index").on("click",".js_house_filter_sort .js_house_sorter_item",function(a){a=
$(this).data("sort");$(".house_filter_sort").val(a);l();k()});$(".js_ng_house_index").on("click",".js_house_index_pages li",function(a){a=$(this).children().data("next-page");$(".house_filter_page").val(a);$("html, body").animate({scrollTop:0},"slow");k()});$(".js_ng_house_index").on("click",".js_house_index_no_result",function(a){n();$(".js_houses_index_query_form").submit()});$(".js_houses_index_query").on("click",function(a){$(this).attr("disabled","disabled");$(".js_house_show_loading").show();
$(".js_houses_index_query_form").submit()});var k=function(){$form=$(".js_houses_index_filter_form");if($form.hasClass("disabled"))return!1;$.ajax({url:$(this).attr("action"),data:$form.serialize(),dataType:"json",type:"GET",context:this,beforeSend:function(){$form.addClass("disabled");n()},complete:function(){$form.removeClass("disabled");$(".js_house_show_loading").hide();$(".js_houses_index_query").removeAttr("disabled");$(".js_house_filter_group span").removeAttr("disabled")},success:function(a){"success"==
a.status&&($(".js_house_index_houses_list").replaceWith(a.html),$(".lazy img").lazyload({threshold:300,effect:"fadeIn"}),p())}})},n=function(){$(".js_house_show_loading").show();$(".js_houses_index_query").attr("disabled","disabled");$(".js_house_filter_group span").attr("disabled","disabled")},l=function(){$(".house_filter_page").val("")};$(".favorite_cmd").tooltip();$(".js-hbanner__functions").on("mouseenter",".favorite_cmd",function(a){$(".js-already_favorite-v2").is(":visible")&&($(".js-already_favorite-v2").addClass("hidden"),
$(".js-cancel_favorite-v2").removeClass("hidden"))});$(".js-hbanner__functions").on("mouseleave",".favorite_cmd",function(a){$(".js-cancel_favorite-v2").is(":visible")&&($(".js-cancel_favorite-v2").addClass("hidden"),$(".js-already_favorite-v2").removeClass("hidden"))});$(".favorite_cmd").live("ajax:success",function(a,b,c,d){$(this).replaceWith(b.html)});$(".js-hbanner__share").popover({trigger:"click",html:!0});$(".js-yu_share_block a").live("click",function(){$(".js-hbanner__share").popover("hide")});
var p=function(){$(".js-house-item-tooltip").tooltip({html:!0,trigger:"hover"})};p();var m=function(){$(".js-house-rooms-item-detail").tooltip({html:!0,trigger:"hover"})};m()});
$(function(){var a=function(a){$.ajax({url:$(a).data("url"),dataType:"json",type:"GET",success:function(a){"success"==a.status&&("group"==a.type?($("#ng_rate_block").replaceWith(a.html),c()):"page"==a.type&&($(".js_ng_rate_list").slickAdd(a.html),$(".js_ng_rate_block_prev").data("url",a.prev_href),$(".js_ng_rate_block_next").data("url",a.next_href),$(".js_ng_rate_list").slickNext()))}})},c=function(){$(".js_ng_rate_list").slick({accessibility:!1,autoplay:!1,draggable:!1,arrows:!1,infinite:!1,slideSpeed:300,
slidesToShow:1,slidesToScroll:1,onAfterChange:function(a,c){$(".js_ng_rate_list_item:first").hasClass("slick-active")?$(".js_ng_rate_block_prev").hide():$(".js_ng_rate_block_prev").show()}})};c();$(document).on({click:function(){$(".js_ng_rate_list").slickPrev()}},"#ng_rate_block_list_prev");$(document).on({click:function(){$(".js_ng_rate_list_item").size()==$(".js_ng_rate_list").slickCurrentSlide()+1?a(this):$(".js_ng_rate_list").slickNext()}},"#ng_rate_block_list_next");$(document).on({click:function(){a(this)}},
".js_ng_rate_nav_filter");$(".js_rate_block").on({submit:function(a){a.preventDefault();a.stopPropagation();if($(this).hasClass("disabled")||!Boolean($(this).find(".content").val().length))return!1;$.ajax({data:$(this).serialize()+"&version=ng",url:$(this).attr("action"),dataType:"json",type:"POST",beforeSend:function(){$(this).addClass("disabled")},success:function(a){"success"==a.status?($(".js_rate_block").replaceWith(a.html),c()):show_simple_alert(a.msg)},complete:function(){$(this).removeClass("disabled")}});
return!1}},".rate_form_section .rate_form");$(".js_rate_block").on({click:function(){$(this).parents(".btn_section").siblings(".content").val("")}},".rate_form_section .cancel_rate")});
$(function(){$(".js_new_retailer_add_other_contacts").on("click",function(){$(".js_new_retailer_other_contacts").append('<div class="nrf__group"><select class="yu-form__select yu-form__select--inline js_new_retailer_select_other_contacts" id="other_contacts" name="other_contacts"><option value="weixin">\u5fae\u4fe1</option> <option value="line">Line</option> <option value="qq">QQ</option> <option value="skype">Skype</option> <option value="msn">Msn</option> <option value="webpage">\u53c2\u8003\u7f51\u9875</option></select> <input class="yu-form__input yu-form__input--inline js_new_retailer_other_contacts_input" name="retailer[other_contacts][weixin]" type="text" /></div>')});$(".js_new_retailer_other_contacts").on({change:function(){$(this).siblings(".js_new_retailer_other_contacts_input").attr("name",
"retailer[other_contacts]["+$(this).val()+"]")}},".js_new_retailer_select_other_contacts");$(".js_new_retailer_resource_type_select").on("change",function(){$.ajax({url:$(this).data("url"),data:{resource_type:$(this).val()},dataType:"json",type:"GET",success:function(a){"success"==a.status&&($(".js_new_retailer_policy_form").html(a.policy_form),$(".js_new_retailer_price_pattern").html(a.price_pattern))}})});$(".js_new_retailer_policy_form").on({click:function(){$(".js_retailer_policy_button.active").removeClass("active");
$(this).addClass("active");var a=$(this).data("target");$(".rrpolicy__panel.active").removeClass("active");$(a).addClass("active");$(".js_retailer_drawback_mode_field").val($(this).data("value"))}},".js_retailer_policy_button");$(".js_new_retailer_price_pattern").on({click:function(){$(".js_rppattern_button.active").removeClass("active");$(this).addClass("active");$(".js_retailer_policy_type_field").val($(this).data("value"))}},".js_rppattern_button");$(".js_bank_country_radio").click(function(){$(".js_bank_country_select").html($(this).next(".js_bank_country_select_html").val())})});
(function(a){a.fn.zclip=function(c){if("object"==typeof c&&!c.length){var b=a.extend({path:"ZeroClipboard.swf",copy:null,beforeCopy:null,afterCopy:null,clickAfter:!0,setHandCursor:!0,setCSSEffects:!0},c);return this.each(function(){var c=a(this);if(c.is(":visible")&&("string"==typeof b.copy||a.isFunction(b.copy))){ZeroClipboard.setMoviePath(b.path);var e=new ZeroClipboard.Client;a.isFunction(b.copy)&&c.bind("zClip_copy",b.copy);a.isFunction(b.beforeCopy)&&c.bind("zClip_beforeCopy",b.beforeCopy);a.isFunction(b.afterCopy)&&
c.bind("zClip_afterCopy",b.afterCopy);e.setHandCursor(b.setHandCursor);e.setCSSEffects(b.setCSSEffects);e.addEventListener("mouseOver",function(a){c.trigger("mouseenter")});e.addEventListener("mouseOut",function(a){c.trigger("mouseleave")});e.addEventListener("mouseDown",function(f){c.trigger("mousedown");a.isFunction(b.copy)?e.setText(c.triggerHandler("zClip_copy")):e.setText(b.copy);a.isFunction(b.beforeCopy)&&c.trigger("zClip_beforeCopy")});e.addEventListener("complete",function(e,g){a.isFunction(b.afterCopy)?
c.trigger("zClip_afterCopy"):(500<g.length&&(g=g.substr(0,500)+"...\n\n("+(g.length-500)+" characters not shown)"),c.removeClass("hover"),alert("Copied text to clipboard:\n\n "+g));b.clickAfter&&c.trigger("click")});e.glue(c[0],c.parent()[0]);a(window).bind("load resize",function(){e.reposition()})}})}if("string"==typeof c)return this.each(function(){var b=a(this);c=c.toLowerCase();var e=b.data("zclipId"),e=a("#"+e+".zclip");"remove"==c?(e.remove(),b.removeClass("active hover")):"hide"==c?(e.hide(),
b.removeClass("active hover")):"show"==c&&e.show()})}})(jQuery);
var ZeroClipboard={version:"1.0.7",clients:{},moviePath:"ZeroClipboard.swf",nextId:1,$:function(a){"string"==typeof a&&(a=document.getElementById(a));a.addClass||(a.hide=function(){this.style.display="none"},a.show=function(){this.style.display=""},a.addClass=function(a){this.removeClass(a);this.className+=" "+a},a.removeClass=function(a){for(var b=this.className.split(/\s+/),d=-1,e=0;e<b.length;e++)b[e]==a&&(d=e,e=b.length);-1<d&&(b.splice(d,1),this.className=b.join(" "));return this},a.hasClass=
function(a){return!!this.className.match(new RegExp("\\s*"+a+"\\s*"))});return a},setMoviePath:function(a){this.moviePath=a},dispatch:function(a,c,b){(a=this.clients[a])&&a.receiveEvent(c,b)},register:function(a,c){this.clients[a]=c},getDOMObjectPosition:function(a,c){var b={left:0,top:0,width:a.width?a.width:a.offsetWidth,height:a.height?a.height:a.offsetHeight};a&&a!=c&&(b.left+=a.offsetLeft,b.top+=a.offsetTop);return b},Client:function(a){this.handlers={};this.id=ZeroClipboard.nextId++;this.movieId=
"ZeroClipboardMovie_"+this.id;ZeroClipboard.register(this.id,this);a&&this.glue(a)}};
ZeroClipboard.Client.prototype={id:0,ready:!1,movie:null,clipText:"",handCursorEnabled:!0,cssEffects:!0,handlers:null,glue:function(a,c,b){this.domElement=ZeroClipboard.$(a);a=99;this.domElement.style.zIndex&&(a=parseInt(this.domElement.style.zIndex,10)+1);"string"==typeof c?c=ZeroClipboard.$(c):"undefined"==typeof c&&(c=document.getElementsByTagName("body")[0]);var d=ZeroClipboard.getDOMObjectPosition(this.domElement,c);this.div=document.createElement("div");this.div.className="zclip";this.div.id=
"zclip-"+this.movieId;$(this.domElement).data("zclipId","zclip-"+this.movieId);var e=this.div.style;e.position="absolute";e.left=""+d.left+"px";e.top=""+d.top+"px";e.width=""+d.width+"px";e.height=""+d.height+"px";e.zIndex=a;if("object"==typeof b)for(addedStyle in b)e[addedStyle]=b[addedStyle];c.appendChild(this.div);this.div.innerHTML=this.getHTML(d.width,d.height)},getHTML:function(a,c){var b="",d="id="+this.id+"&width="+a+"&height="+c;if(navigator.userAgent.match(/MSIE/))var e=location.href.match(/^https/i)?
"https://":"http://",b=b+('<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+e+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+a+'" height="'+c+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+ZeroClipboard.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+
d+'"/><param name="wmode" value="transparent"/></object>');else b+='<embed id="'+this.movieId+'" src="'+ZeroClipboard.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+a+'" height="'+c+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+d+'" wmode="transparent" />';return b},hide:function(){this.div&&(this.div.style.left=
"-2000px")},show:function(){this.reposition()},destroy:function(){if(this.domElement&&this.div){this.hide();this.div.innerHTML="";var a=document.getElementsByTagName("body")[0];try{a.removeChild(this.div)}catch(c){}this.div=this.domElement=null}},reposition:function(a){a&&((this.domElement=ZeroClipboard.$(a))||this.hide());if(this.domElement&&this.div){a=ZeroClipboard.getDOMObjectPosition(this.domElement);var c=this.div.style;c.left=""+a.left+"px";c.top=""+a.top+"px"}},setText:function(a){this.clipText=
a;this.ready&&this.movie.setText(a)},addEventListener:function(a,c){a=a.toString().toLowerCase().replace(/^on/,"");this.handlers[a]||(this.handlers[a]=[]);this.handlers[a].push(c)},setHandCursor:function(a){this.handCursorEnabled=a;this.ready&&this.movie.setHandCursor(a)},setCSSEffects:function(a){this.cssEffects=!!a},receiveEvent:function(a,c){a=a.toString().toLowerCase().replace(/^on/,"");switch(a){case "load":this.movie=document.getElementById(this.movieId);if(!this.movie){var b=this;setTimeout(function(){b.receiveEvent("load",
null)},1);return}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){b=this;setTimeout(function(){b.receiveEvent("load",null)},100);this.ready=!0;return}this.ready=!0;try{this.movie.setText(this.clipText)}catch(d){}try{this.movie.setHandCursor(this.handCursorEnabled)}catch(e){}break;case "mouseover":this.domElement&&this.cssEffects&&(this.domElement.addClass("hover"),this.recoverActive&&this.domElement.addClass("active"));break;case "mouseout":this.domElement&&
this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("active")&&(this.domElement.removeClass("active"),this.recoverActive=!0),this.domElement.removeClass("hover"));break;case "mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case "mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("active"),this.recoverActive=!1)}if(this.handlers[a])for(var f=0,g=this.handlers[a].length;f<g;f++){var h=this.handlers[a][f];if("function"==typeof h)h(this,
c);else if("object"==typeof h&&2==h.length)h[0][h[1]](this,c);else if("string"==typeof h)window[h](this,c)}}};
$(function(){$("#js_referral_copy_generated_url_cmd").zclip({path:"/assets/ZeroClipboard.swf",copy:function(){return $("#js_referral_generated_url").val()},afterCopy:function(){show_simple_alert("\u590d\u5236\u6210\u529f\uff01")}});$(".js_referrals_tips1").hover(function(a){$(this).popover({title:"\u5f53\u9047\u5230\u4ee5\u4e0b\u4e09\u79cd\u60c5\u51b5\u4e4b\u4e00\u65f6\uff0c\u5927\u9c7c\u4e5f\u641e\u4e0d\u5b9a\u5566",content:"1. \u5c0f\u4f19\u4f34\u5728\u70b9\u51fb\u60a8\u7684\u94fe\u63a5\u4e4b\u524d\u5df2\u7ecf\u901a\u8fc7\u522b\u4eba\u7684\u4e13\u5c5e\u94fe\u63a5\u6765\u8fc7\u5927\u9c7c\u4e86\uff0c\u6240\u4ee5TA\u5c31\u4e0d\u662f\u60a8\u7684\u4eba\u4e86\u2026\u2026<br>2. TA\u5df2\u7ecf\u662f\u5927\u9c7c\u6ce8\u518c\u7528\u6237\u4e86<br>3. TA\u662f\u4e2a\u6d01\u7656\u5e76\u6e05\u7a7a\u4e86\u6d4f\u89c8\u5668cookie\uff01",
html:!0}).popover("show")},function(a){$(this).popover("hide")});$(".js_referrals_tips2").hover(function(){$(this).popover({title:"",content:"\u5927\u9c7c\u53ea\u6709\u5728\u786e\u8ba4\u4e86TA\u65e0\u6cd5\u518d\u9000\u6b3e\u7684\u524d\u63d0\u4e0b\uff0c\u624d\u4f1a\u5c06\u5206\u7ea2\u7ed9\u60a8\uff0c\u8fd9\u4e2a\u65f6\u95f4\u901a\u5e38\u662f\u5728\u5165\u4f4f\u6216\u670d\u52a1\u5f53\u5929\u7684\u524d\u540e",html:!0}).popover("show")},function(){$(this).popover("hide")});$(".js_referral_complete_bank_cmd").bind("click",
function(){$(".referrals-bank-info").addClass("error")});$(".js_referral_new_exchange_cmd").bind("click",function(){$(".referral-exchange-modal").modal("show");return!1});$(".js_referrals_show_orders").bind("click",function(){$(".rhome__order-table").toggle();return!1});$(".js_referrals_show_chart").bind("click",function(){$("#chart").toggle();return!1});$(".js_referral_generate_url_cmd").on("click",function(a){a=$(this);$.ajax({url:a.data("url"),data_type:"json",type:"GET",data:{url:$(".js_referral_origin_url").val()}}).success(function(a,
b,d){"success"==a.status&&$(".js_referral_generated_url").val(a.url)})});$(".js_referral_hot_url").on("click",function(){$(".js_referral_origin_url").val($(this).attr("href"));$(".js_referral_generate_url_cmd").trigger("click");$(".js_referral_copy_generated_url_cmd").trigger("click");return!1})});$(function(){$(".js_hunter_show_product_desc").scroller({customClass:"hunter-scrollbar"})});
$(function(){0<$(".js_collection_fixed_tab_nav").length&&$(".js_collection_fixed_tab_nav").affix({offset:{top:$(".js_collection_fixed_tab_nav").offset().top,bottom:function(){return this.bottom=$(".footer").outerHeight(!0)}}});$(".js_collection_fixed_tab_nav").on("affixed.bs.affix",function(a){$(".js_affixed_element").css("height","56px")});$(".js_collection_fixed_tab_nav").on("affixed-top.bs.affix",function(a){$(".js_affixed_element").css("height","0px")})});
(function(){$(".js_travel_suit_mobile_selector").change(function(a){a=$(".js_travel_suit_mobile_selector option:selected");var c=a.data("desc");a.data("id")?($(".js_travel_suit_mobile_desc").text(c),$(".js_travel_suit_mobile_selector").removeClass("warning")):$(".js_travel_suit_mobile_desc").text("")});$(".js_need_more_travel_suit").click(function(a){$.post("/activities/update_suit_count",function(a,b,d){"failed"==a.status?show_simple_alert("\u5927\u9c7c\u5df2\u7ecf\u6536\u5230\u60a8\u7684\u53cd\u9988~"):
($(".js_travel_suit_need").text(a.count),show_simple_alert("\u8c22\u8c22\u60a8\u7684\u53cd\u9988\uff01"))})});$(".mobile_tour_buy_cmd").bind("click",function(){var a=$(this),c=$(".js_travel_suit_mobile_selector option:selected");c.data("id")?(c=a.data("url")+"&rid="+c.data("id"),a.attr("href",c)):$(".js_travel_suit_mobile_selector").addClass("warning")});$(".tour_buy_cmd").bind("click",function(){var a=$(this),c=a.parents(".tour_projects_list"),b=c.find(".tour_project_id");if(""==b.val())return c.find(".js_travel_suit_tour_projects").addClass("warning"),
c.find(".js_tsuit_tour_projects_select_warn").show(),!1;c=a.attr("href")+"&rid="+b.val();a.attr("href",c)});$(".switch_project_cmd").bind("click",function(){var a=$(this),c=a.parents(".tour_projects_list");c.find(".tour_project_id").val(a.data("id"));c.find(".name > a").removeClass("active");a.addClass("active");c.find(".price").html(a.data("price"));c.find(".desc").html(a.data("desc"));c.find(".js_travel_suit_tour_projects").removeClass("warning");c.find(".js_tsuit_tour_projects_select_warn").hide()})})();
$(function(){var a=$(".js_travel_suit_left"),c=$(".tour_projects_list");c.height()<a.height()&&c.height(a.height())});
$(function(){$(".js-binding-old-user-form").validate({rules:{"user[email]":{required:!0,email:!0},"user[password]":{required:!0,minlength:6}}});$(".js-binding-new-user-form").validate({rules:{"user[email]":{required:!0,email:!0,remote:{url:"/users/register_form_check",type:"get"}},"user[password]":{required:!0,minlength:6},"user[password_confirmation]":{equalTo:".connection-need-confirmation"},"user[nickname]":{required:!0,zhRangeLength:[2,15],remote:{url:"/users/register_form_check",type:"get"}},
invitation_code:{remote:{url:"/invitation_codes/check",type:"get"}},tos:"required"},messages:{"user[email]":{remote:"\u8be5\u7535\u5b50\u90ae\u7bb1\u5730\u5740\u5df2\u5b58\u5728"},"user[nickname]":{remote:"\u8be5\u6635\u79f0\u5df2\u5b58\u5728/\u4e0d\u5408\u6cd5"},invitation_code:{remote:"\u4f18\u60e0\u7801\u65e0\u6548\u6216\u8fc7\u671f"}}});$(".js-select-form").change(function(){var a=show_form_class=this.checked?$(".js-binding-old-user"):$(".js-binding-new-user");$(".js-connections-binding-page").find(".connections-page-form").hide();
$(a).show()})});
$(function(){var a=function(a,c,e,f){if(16!=$(".js_payment_coupon_code").val().trim().length)return!1;a=function(a,b,c){"success"==a.status?$(".js_payment_coupon_message").text(a.data.coupon_message):"failed"==a.status&&$(".js_payment_coupon_message").text(a.data.coupon_message)};$.ajax({url:c,dataType:"json",type:"PUT",data:e,success:f||a})},c=function(a){"success"==a.status?($(".js_payment_coupon").replaceWith(a.html_v2),$(".js_payment_price").replaceWith(a.payment_price)):$(".js_payment_coupon_message").text(a.data.coupon_message)};$(".js_payment_coupon").parent().on({click:function(b){var d=
$(".js_payment_coupon_input_form"),e=d.data("freeze-coupon-path"),d=d.serialize();a(this,e,d,c);b.preventDefault();return!1}},".js_payment_coupon_use");$(".js_payment_coupon").parent().on({click:function(b){var d=$(".js_payment_coupon_input_form"),e=d.data("unfreeze-coupon-path"),d=d.serialize();a(this,e,d,c);b.preventDefault();return!1}},".js_payment_coupon_unuse");$(".js_payment_coupon").parent().on({change:function(){var b=$(this).val(),b=b.trim();if(16==b.length){var c=$(".js_payment_coupon_input_form"),
b=c.data("check-coupon-path"),c=c.serialize();a(this,b,c)}else $(".js_payment_coupon_message").text("")}},".js_payment_coupon_code");$(".js_payment_coupon").parent().on({change:function(){$(".js_payment_coupon_code").prop("disabled",!$(this).prop("checked"));$(this).prop("checked")?($(".js_payment_coupon_use").removeClass("payment-coupon__use--negative disabled"),$(".js_payment_coupon_code").focus()):$(".js_payment_coupon_use").addClass("payment-coupon__use--negative disabled")}},".js_payment_coupon_switch")});
$(function(){$.validator.setDefaults({errorPlacement:function(a,c){a.appendTo(c.parent())},onkeyup:!1});$(".js_payment_coupon_input_form").each(function(){$(this).validate({rules:{coupon_code:{maxlength:16,minlength:16}}})});$(".js_payment_selection_coupon_code").live("change",function(){$(".js_payment_coupon_input_form").each(function(){$(this).validate({rules:{coupon_code:{maxlength:16,minlength:16}}})})});$(".signup_form").validate({rules:{"user[email]":{required:!0,email:!0,remote:{url:"/users/register_form_check",
type:"get"}},"user[password]":{required:!0,minlength:6},"user[password_confirmation]":{equalTo:"#user_password"},"user[nickname]":{required:!0,zhRangeLength:[2,15],remote:{url:"/users/register_form_check",type:"get"}},tos:"required"},messages:{"user[email]":{remote:"\u8be5\u7535\u5b50\u90ae\u7bb1\u5730\u5740\u5df2\u5b58\u5728"},"user[nickname]":{remote:"\u8be5\u6635\u79f0\u5df2\u5b58\u5728/\u4e0d\u5408\u6cd5"}}});$(".login_form").validate({rules:{"user[email]":{required:!0,email:!0},"user[password]":{required:!0,
minlength:6}}});$(".js-new-house-order").validate({rules:{"user[email]":{required:!0,email:!0},"user[password]":{required:!0,minlength:6},"order[order_contact_attributes][real_name]":{required:!0},"order[order_contact_attributes][cellphone]":{required:!0,isPhone:!0},"order[order_contact_attributes][email]":{required:!0,email:!0},"order[attendence_attributes][0][real_name]":{required:!0},"house_order[adult_number]":{required:!0,number:!0},"house_order[children_number]":{required:!0,number:!0}}});$(".js-order-attendence-gender-num").each(function(){$(this).rules("add",
{isSum:[".js-order-attendence-page",".js-order-attendence-gender-num"]})});$(".js-order-attendence-gender-num").on("change",function(){$(this).parents(".js-order-attendence-page").find(".js-order-attendence-gender-num").valid()});$(".shareholder-apply-form").validate({rules:{"referral_user[name]":{required:!0},"referral_user[mail]":{required:!0,email:!0},"referral_user[cellphone]":{required:!0,isPhone:!0},"referral_user[resume]":{required:!0}}})});
$(function(){var a=function(a){for(var b=0,d=0;d<a.length;d++)b=128>a.charCodeAt(d)?b+.5:b+1;return b};jQuery.validator.addMethod("isSum",function(a,b,d){a=d[0];d=d[1];b=$(b).parents(a);d=b.find(d);for(a=items_num=0;a<d.length;a++)items_num+=parseInt($(d[a]).val());b=b.data("guest-num");return parseInt(items_num)==parseInt(b)},"\u7537\u6027\u5973\u6027\u4eba\u6570\u4e4b\u548c\u4e0e\u8be5\u623f\u95f4\u5165\u4f4f\u603b\u4eba\u6570\u4e0d\u7b26");jQuery.validator.addMethod("isMobile",function(a,b){var d=
a.length,e=/^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+\d{8})$/;return this.optional(b)||11==d&&e.test(a)},"\u8bf7\u6b63\u786e\u586b\u5199\u60a8\u7684\u624b\u673a\u53f7\u7801");jQuery.validator.addMethod("isTelephone",function(a,b){var d=/^\d{3,4}-?\d{7,9}$/;return this.optional(b)||d.test(a)},"\u8bf7\u6b63\u786e\u586b\u5199\u60a8\u7684\u7535\u8bdd\u53f7\u7801");jQuery.validator.addMethod("isCellphone",function(a,b){var d=/^\d{8,}$/;return this.optional(b)||d.test(a)},"\u8bf7\u6b63\u786e\u586b\u5199\u60a8\u7684\u7535\u8bdd\u53f7\u7801");
jQuery.validator.addMethod("isPhone",function(a,b){var d=/^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1})|(17[0-9]{1}))+\d{8})$/,e=/^\d{3,4}-?\d{7,9}$/;return this.optional(b)||e.test(a)||d.test(a)},"\u8bf7\u6b63\u786e\u586b\u5199\u60a8\u7684\u8054\u7cfb\u7535\u8bdd");jQuery.validator.addMethod("zhRangeLength",function(c,b,d){c=a(c);return this.optional(b)||c>=d[0]&&c<=d[1]},jQuery.format("\u8bf7\u786e\u4fdd\u8f93\u5165\u7684\u503c\u5728 {0}-{1} \u4e2a\u5b57\u7b26\u4e4b\u95f4(\u82f1\u6587\u8ba1\u534a\u4e2a\u5b57\u7b26)"));
jQuery.validator.addMethod("zhMinLength",function(c,b,d){c=a(c);return this.optional(b)||c>=d},jQuery.format("\u8bf7\u786e\u4fdd\u8f93\u5165\u7684\u503c\u5927\u4e8e {0} \u4e2a\u5b57\u7b26(\u82f1\u6587\u8ba1\u534a\u4e2a\u5b57\u7b26)"));jQuery.validator.addMethod("zhMaxLength",function(c,b,d){c=a(c);return this.optional(b)||c<=d},jQuery.format("\u8bf7\u786e\u4fdd\u8f93\u5165\u7684\u503c\u5c0f\u4e8e{0}\u4e2a\u5b57\u7b26(\u82f1\u6587\u8ba1\u534a\u4e2a\u5b57\u7b26)"));jQuery.validator.addMethod("checkDataMax",
function(a,b,d){a=+a;d=+$(b).data(d);d=isNaN(d)||0==d||a<=d;return this.optional(b)||d},jQuery.format("\u8d85\u8fc7\u5141\u8bb8\u7684\u6700\u5927\u503c\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"))});
$(function(){$(".rate_form").live("ajax:success",function(a,b,d){"success"==b.status?(a=$(this).parent(".rate_form_section"),d=$(a).siblings(".list_field").find(".list"),$(b.html).prependTo(d).hide().slideDown(300),$(a).hide(),$("p.empty_list").remove()):show_simple_alert(b.msg)});$(".rate_reply_form").live("ajax:success",function(a,b,d){"success"==b.status?(a=$(this).find(".reply_text"),$(a).val(""),$(b.html).appendTo($(this).prev(".reply_list")).hide().slideDown(300),$(this).hide()):show_simple_alert(b.msg)});
$(".rate_item").live("hover",function(a){$(this).find(".cmd").toggle()});$(".reply_cmd").live("click",function(a){a=$(this).parents(".bottom_line").siblings(".reply_list");a=$(a).next(".rate_reply_form");$(a).show();$(a).find(".reply_text").focus()});$(".cancel_rate").live("click",function(){$(this).parents(".btn_section").siblings(".content").val("");$(this).parents(".rate_form").data("validator").resetForm()});$(".cancel_reply").live("click",function(){var a=$(this).parents(".rate_reply_form");
$(this).parents(".btn_section").prev(".reply_text").val("");$(a).hide();$(a).data("validator").resetForm();return!1});var a=$(".star").last();$(".star_section").live("mouseout",function(){$(a).prevAll(".star").html("<span class='yicon-star-on'></span>");$(a).html("<span class='yicon-star-on'></span>");$(a).nextAll(".star").html("<span class='yicon-star-off'></span>");$(".star_section .desc").html($(a).attr("data-desc"))});$(".star").live("hover",function(){$(this).prevAll(".star").html("<span class='yicon-star-on'></span>");
$(this).html("<span class='yicon-star-on'></span>");$(this).nextAll(".star").html("<span class='yicon-star-off'></span>");$(".star_section .desc").html($(this).attr("data-desc"))});$(".star").live("mouseup",function(){$(this).siblings(".rate_stars").attr("value",$(this).attr("data-value"));a=$(this)});$(".rate_list_filter_cmd").on("ajax:success",function(a,b,d,e){"success"==d&&(a=$(this).parents(".rate_block"),$(a).find(".list_field").html(b.html),$(a).find(".filter-item.active").removeClass("active"),
$(this).find(".filter-item").addClass("active"))});$(".more_rates_cmd").on("ajax:success",function(a,b,d,e){"success"==d&&($(this).parents(".list_field").find("> .list").replaceWith(b.html),$(this).hide())})});var _customEvent="gaRefresh",_replaceWith,_append,_ga;
(function(a){_replaceWith=a.fn.replaceWith;a.fn.replaceWith=function(){var c=a(this).parent(),b=_replaceWith.apply(this,arguments);c.trigger(_customEvent);return b};_append=a.fn.append;a.fn.append=function(){var c=_append.apply(this,arguments);a(this).trigger(_customEvent);return c}})(jQuery);
function getGaData(a,c){var b={};"undefined"==typeof c&&(c="id list name category price position quantity".split(" "));$.each(c,function(c,e){var f=a.data("ga-"+e);"undefined"!=typeof f&&(b[e]=f)});return b}
(function(a){var c=!1;a(".js-ga-house-index").on(_customEvent,function(b){b.stopPropagation();ga("set","&dl",a(".js-ga-houses").data("ga-url"));a(".js-ga-house").each(function(b,c){a(c).data("ga-position",b);var f=getGaData(a(c));f.list="list houses: "+a(".js-ga-houses").data("ga-name");ga("ec:addImpression",f);0<b&&0==b%10&&ga("send","event","ecommerce","list",a(".js-ga-houses").data("ga-name"),{nonInteraction:1})});ga("set","dimension1",a(".js-ga-data").data("ga-country"));ga("send","pageview");
c=!0}).triggerHandler(_customEvent);a(".js-ga-house-index").on("click",".js-ga-house a",function(){ga("set","&dl",a(".js-ga-houses").data("ga-url"));ga("ec:addProduct",getGaData(a(this).parents(".js-ga-house")));ga("ec:setAction","click",{list:"list houses: "+a(".js-ga-houses").data("ga-name")});ga("send","pageview")});a(".js-ga-rooms").on(_customEvent,function(){ga("set","&dl",a(".js-ga-rooms-list").data("ga-url"));a(".js-ga-room").each(function(b,c){var e=getGaData(a(c));e.list="list rooms: "+a(".js-ga-rooms-list").data("ga-name");
ga("ec:addImpression",e)});ga("set","dimension1",a(".js-ga-data").data("ga-country"));ga("send","pageview");c=!0}).triggerHandler(_customEvent);a(".js-ga-rooms").on("click",".js-ga-room",function(){ga("set","&dl",a(".js-ga-rooms-list").data("ga-url"));ga("ec:addProduct",getGaData(a(this)));ga("ec:setAction","click",{list:"list rooms: "+a(".js-ga-rooms-list").data("ga-name")});ga("send","pageview")});a(".js-ga-order-new, .js-ga-mobile-order-new").on(_customEvent,function(b){b.stopPropagation();ga("ec:addProduct",
getGaData(a(this)));ga("ec:setAction","checkout",{step:1})}).triggerHandler(_customEvent);a(".js-ga-order-submit-success, .js-ga-mobile-order-submit-success").on(_customEvent,function(b){b.stopPropagation();b=a(this);var c=b.data("ga-auto-confirm");ga("ec:addProduct",getGaData(b));ga("ec:setAction","checkout",a.extend({step:2,id:b.data("ga-order-id")},c?{option:"auto-confirm"}:{}))}).triggerHandler(_customEvent);a(".js-ga-prepay, .js-ga-mobile-prepay").on(_customEvent,function(b){b.stopPropagation();
b=a(this);ga("ec:addProduct",getGaData(b));ga("ec:setAction","checkout",{step:3,id:b.data("ga-order-id")})}).triggerHandler(_customEvent);a(".js-ga-pay-success, .js-ga-mobile-pay-success").on(_customEvent,function(b){b.stopPropagation();b=a(this);var c=getGaData(b);ga("ec:addProduct",c);ga("ec:setAction","purchase",{id:b.data("ga-order-id"),revenue:b.data("ga-full-price")});"undefined"!=typeof _hmt&&_hmt.push(["_trackOrder",{orderId:b.data("ga-order-id"),orderTotal:b.data("ga-full-price"),item:[{skuId:c.id,
skuName:c.name,category:c.category,Price:c.price,Quantity:c.quantity}]}])}).triggerHandler(_customEvent);a(".js-ga-mobile-houses").on(_customEvent,function(b){b.stopPropagation();b=a(this).data("lastPosition");"undefined"==typeof b&&(b=0);a(".js-ga-mobile-house").each(function(b,c){if(!(a(c).data("ga-position")>=b)){a(c).data("ga-position",b);var f=getGaData(a(c));f.list="list houses: "+a(".js-ga-mobile-houses").data("ga-name");ga("ec:addImpression",f);0<b&&0==b%10&&ga("send","event","ecommerce",
"list",a(".js-ga-mobile-houses").data("ga-name"))}});a(this).data("lastPosition",a(".js-ga-mobile-house").length);ga("send","pageview");c=!0}).triggerHandler(_customEvent);a(".js-ga-mobile-houses").on("click",".js-ga-mobile-house a",function(b){ga("ec:addProduct",getGaData(a(this).parents(".js-ga-mobile-house")));ga("ec:setAction","click",{list:"list houses: "+a(".js-ga-mobile-houses").data("ga-name")});ga("send","pageview")});a(".js-ga-mobile-rooms").on(_customEvent,function(b){a(".js-ga-mobile-room").each(function(b,
c){a(this).data("ga-position",b);var f=getGaData(a(c));f.list="list rooms: "+a(".js-ga-mobile-rooms").data("ga-name");ga("ec:addImpression",f)});ga("send","pageview");c=!0}).triggerHandler(_customEvent);a(".js-ga-mobile-rooms").on("click",".js-ga-mobile-room",function(b){ga("ec:addProduct",getGaData(a(this)));ga("ec:setAction","click",{list:"list rooms: "+a(".js-ga-mobile-rooms").data("ga-name")});ga("send","pageview")});c||"undefined"!=typeof ga&&ga("send","pageview")})(jQuery);
