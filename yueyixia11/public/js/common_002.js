/*!module/util/util.js*/
;define("module/util/util",function(e,t,r){"use strict";Date.prototype.format=function(e){var t=["日","一","二","三","四","五","六"],r={"M+":this.getMonth()+1,"d+":this.getDate(),"w+":t[this.getDay()],"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in r)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?r[n]:("00"+r[n]).substr((""+r[n]).length)));return e};var n={};n.getQueryString=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),r=window.location.search.substr(1).match(t);return null!=r?unescape(r[2]):null},n.updateQueryStringParameter=function(e,t){var e=e||location.host,r=Object.keys(t);return r.forEach(function(r){var n=new RegExp("([?&])"+r+"=.*?(&|$)","i"),i=-1!==e.indexOf("?")?"&":"?";e=e.match(n)?e.replace(n,"$1"+r+"="+t[r]+"$2"):e+i+r+"="+t[r]}),e},n.cache={},n.setCache=function(e,t){var r=window.localStorage;return r?("object"==typeof t&&(t=JSON.stringify(t)),r.setItem(e,t)):n.cache[e]=t},n.getCache=function(e){var t=window.localStorage;return t?JSON.parse(t.getItem(e)):n.cache[e]},n.convertToObj=function(e){if("string"!=typeof e||!e)return e;var t,r,n,i={},a=e.split("&");for(r=0,n=a.length;n>r;r++)t=a[r].split("="),i[t[0]]=t[1];return i},n.lexicographicalOrder=function(e){if("object"!=typeof e)return e;var t,r,n=_.keys(e),i=n.length,a={};for(n.sort(),t=0;i>t;t++)r=n[t],a[r]=e[r];return a},n.encry=function(e){var t=Date.parse(new Date)/1e3,r={app_id:"fishtrip_web",timestamp:t};"string"==typeof e&&(e=n.convertToObj(e));var i=n.lexicographicalOrder(_.extend(r,e)),a=md5($.param(i)+"3858f62230ac3c915f300c664312c63f");return _.extend(i,{sign:a})},n.isWeixin=function(){var e=navigator.userAgent.toLowerCase();return"micromessenger"==e.match(/MicroMessenger/i)?!0:!1},n.secondToTime=function(e){var t=parseInt(e,10),r=Math.floor(t/3600),n=Math.floor((t-3600*r)/60),i=t-3600*r-60*n;10>r&&(r="0"+r),10>n&&(n="0"+n),10>i&&(i="0"+i);var a=r+":"+n+":"+i;return a},n.diffDate=function(e,t){return(Date.parse(t)-Date.parse(e))/864e5},n.verify={checkNull:function(e){return String(e)},checkChinaPhone:function(e){var t=/^\d{11}$/;return t.test(Number(e))},checkPhone:function(e){var t=/^\d{8,11}$/;return t.test(Number(e))},checkCaptcha:function(e){var t=/^\d{6}$/;return t.test(Number(e))},checkPassword:function(e){var t=/^.{6,18}$/;return t.test(e)},checkEmail:function(e){var t=/^[\w-]+(\.[\w-]+)*@([\w-]+\.)+[a-zA-Z]+$/;return t.test(e)},checkNum:function(e,t,r,n){if(isNaN(e))return!1;if(n){if(t>e||e>r)return!1}else if(t>=e||e>=r)return!1;return!0},checkDate:function(e){var t=/(((^((1[8-9]\d{2})|([2-9]\d{3}))([-\/\._])(10|12|0?[13578])([-\/\._])(3[01]|[12][0-9]|0?[1-9]))|(^((1[8-9]\d{2})|([2-9]\d{3}))([-\/\._])(11|0?[469])([-\/\._])(30|[12][0-9]|0?[1-9]))|(^((1[8-9]\d{2})|([2-9]\d{3}))([-\/\._])(0?2)([-\/\._])(2[0-8]|1[0-9]|0?[1-9]))|(^([2468][048]00)([-\/\._])(0?2)([-\/\._])(29))|(^([3579][26]00)([-\/\._])(0?2)([-\/\._])(29))|(^([1][89][0][48])([-\/\._])(0?2)([-\/\._])(29))|(^([2-9][0-9][0][48])([-\/\._])(0?2)([-\/\._])(29))|(^([1][89][2468][048])([-\/\._])(0?2)([-\/\._])(29))|(^([2-9][0-9][2468][048])([-\/\._])(0?2)([-\/\._])(29))|(^([1][89][13579][26])([-\/\._])(0?2)([-\/\._])(29))|(^([2-9][0-9][13579][26])([-\/\._])(0?2)([-\/\._])(29)))((\s+(0?[1-9]|1[012])(:[0-5]\d){0,2}(\s[AP]M))?$|(\s+([01]\d|2[0-3])(:[0-5]\d){0,2})?$))/;return t.test(e)}},r.exports=n});
/*!components/sessions/codelist.jsx*/
;define("components/sessions/codelist.jsx",function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),u=function(e,t,o){for(var n=!0;n;){var r=e,a=t,i=o;n=!1,null===r&&(r=Function.prototype);var u=Object.getOwnPropertyDescriptor(r,a);if(void 0!==u){if("value"in u)return u.value;var l=u.get;return void 0===l?void 0:l.call(i)}var c=Object.getPrototypeOf(r);if(null===c)return void 0;e=c,t=a,o=i,n=!0,u=c=void 0}},l=e("module/util/util"),c=n(l),s=function(e){function t(e){r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.displayName="CellphoneCode",this.state={list:[]}}return a(t,e),i(t,[{key:"render",value:function(){var e=this.state.list.map(function(e,t){var o=e.key.replace(/^00/,"+");return React.createElement("option",{value:e.key,key:t},e.value," ",o)});return React.createElement("select",{className:this.props.className,onChange:this.handleChose.bind(this)},e)}},{key:"handleChose",value:function(e){this.props.onChose(e.target.value)}},{key:"componentDidMount",value:function(){var e=this,t="http://api.fishtrip.cn/api/v2/common/country_codes";c["default"].getCache(t)?this.setState({list:c["default"].getCache(t)}):$.get(t,function(o){c["default"].setCache(t,o),e.setState({list:o})})}}]),t}(React.Component);s.defaultProps={onChose:function(){}},t["default"]=s,o.exports=t["default"]});
/*!components/sessions/login.jsx*/
;define("components/sessions/login.jsx",function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e,t,n){for(var a=!0;a;){var s=e,r=t,c=n;a=!1,null===s&&(s=Function.prototype);var o=Object.getOwnPropertyDescriptor(s,r);if(void 0!==o){if("value"in o)return o.value;var i=o.get;return void 0===i?void 0:i.call(c)}var l=Object.getPrototypeOf(s);if(null===l)return void 0;e=l,t=r,n=c,a=!0,o=l=void 0}},l=e("components/sessions/codelist.jsx"),u=a(l),h=function(e){function t(e){s(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.displayName="Login",this.state={couldSubmit:!1,warnText:{}}}return r(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=this.state,n=e.global?"#global/":"#/",a=[];return _.mapObject(t.warnText,function(e,t){e&&a.push(React.createElement("li",{key:t},e))}),React.createElement("div",c({},e,{className:"sessions-login"}),React.createElement("div",{className:"sessions-title"},React.createElement("a",{href:n+"login",className:"active"},"登录大鱼"),React.createElement("a",{href:n+"register"},"注册新用户")),React.createElement("form",{className:"sessions-form",onSubmit:this.submitForm.bind(this)},React.createElement("div",{className:"sessions-cellphone"},React.createElement("div",{className:"cellphone-code"},React.createElement("span",{className:"code-blk"},React.createElement(u["default"],{className:"code-select",onChose:this.handleGetCellphoneCode.bind(this)})),React.createElement("span",{className:"yicon-select-down select-down"})),React.createElement("input",{className:"form-input "+(t.warnText.cellphone?"warn":""),placeholder:"请输入您注册的手机号码",type:"telephone",name:"cellphone",maxLength:11,value:e.user.get("cellphone"),onChange:this.handleSetPhone.bind(this),onBlur:this.handleVerify.bind(this)})),React.createElement("div",{className:"sessions-password"},React.createElement("input",{type:"text",style:{display:"none"}}),React.createElement("input",{className:"form-input "+(t.warnText.password?"warn":""),placeholder:"请输入密码",size:"30",type:"password",name:"password",value:e.user.get("password"),onChange:this.handleSetPassword.bind(this),onBlur:this.handleVerify.bind(this)}),React.createElement("div",{className:"input-text"},React.createElement("a",{href:n+"findPassword",className:"input-link"},"忘记密码"))),React.createElement("div",{className:"sessions-remberme checkbox"},React.createElement("label",{htmlFor:"sessions-remberme"},React.createElement("input",{type:"checkbox",id:"sessions-remberme",onChange:this.remberme.bind(this),defaultChecked:"checked"}),"下次自动登录")),React.createElement("ul",{className:"sessions-warn"},a),React.createElement("button",{className:"sessions-submit",type:"submit",disabled:!t.couldSubmit},"登录")),React.createElement("div",{className:"sessions-other-link"},React.createElement("a",{href:"#global/weixinLogin",className:"pull-left"},"微信登录"),React.createElement("a",{href:"http://s.fishtrip.cn",className:"pull-right"},"我是供应商")))}},{key:"remberme",value:function(e){this.props.user.set("remember_me",+e.currentTarget.checked)}},{key:"handleGetCellphoneCode",value:function(e){this.props.user.set("country_code",e),this.checkValue()}},{key:"checkValue",value:function(){var e=this.props.user;this.setState({couldSubmit:e.check("cellphone").checked&&e.check("password").checked})}},{key:"submitForm",value:function(e){e.preventDefault();var t=this;this.props.user.login(function(e,n){t.setState({warnText:{remote:n}})})}},{key:"handleVerify",value:function(e){var t=this.props.user.check(e.target.name),n={};n[e.target.name]=t.txt;var a=React.addons.update(this.state.warnText,{$merge:n});this.setState({warnText:a})}},{key:"handleSetPhone",value:function(e){this.props.user.set({cellphone:e.target.value}),this.checkValue()}},{key:"handleSetPassword",value:function(e){this.props.user.set({password:e.target.value}),this.checkValue()}},{key:"componentWillMount",value:function(){var e=this;this.props.user.on("change",function(){e.checkValue(),e.forceUpdate()},this)}},{key:"componentDidMount",value:function(){this.checkValue()}},{key:"componentWillUnmount",value:function(){this.props.user.off("change")}}]),t}(React.Component),p=function(e){function t(){s(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return r(t,e),o(t,[{key:"render",value:function(){var e=location.host.match(/alpha/),t=location.host.match(/www.fishtrip.cn/),n="";return n=e?"http://alpha.fishtrip.cn":t?"http://www.fishtrip.cn":location.host,React.createElement("div",null,React.createElement("div",{className:"sessions-title"},React.createElement("div",{className:"sessions-back-icon"},React.createElement("a",{href:"javascript: history.go(-1)",className:"yicon-back-normal"}," "))),React.createElement("iframe",{src:n+"/connections/new?site=weixin_web",width:"100%",height:"420px",ref:"iframe"}))}}]),t}(React.Component);t["default"]={Login:h,WeixinLogin:p},n.exports=t["default"]});
/*!components/sessions/register.jsx*/
;define("components/sessions/register.jsx",function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}(),c=function(e,t,a){for(var s=!0;s;){var n=e,r=t,o=a;s=!1,null===n&&(n=Function.prototype);var c=Object.getOwnPropertyDescriptor(n,r);if(void 0!==c){if("value"in c)return c.value;var i=c.get;return void 0===i?void 0:i.call(o)}var l=Object.getPrototypeOf(n);if(null===l)return void 0;e=l,t=r,a=o,s=!0,c=l=void 0}},i=e("components/sessions/codelist.jsx"),l=s(i),u=function(e){function t(e){n(this,t),c(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.displayName="Register",this.state={couldSubmit:!1,couldSendCaptch:!1,findPasswordDone:!1,warnText:{}}}return r(t,e),o(t,[{key:"renderTitle",value:function(){var e=this.props.global?"#global/":"#/";return this.props.isFindPassword?React.createElement("div",{className:"sessions-title"},React.createElement("div",{className:"sessions-back-icon"},React.createElement("a",{href:"javascript: history.go(-1)",className:"yicon-back-normal"}," ")),React.createElement("h3",null,"重置密码")):React.createElement("div",{className:"sessions-title"},React.createElement("a",{href:e+"login"},"登录大鱼"),React.createElement("a",{href:e+"register",className:"active"},"注册新用户"))}},{key:"renderDone",value:function(){var e=this.props.global?"#global/":"#/";return React.createElement("div",{className:"sessions-reset-ok"},React.createElement("strong",null,"重置密码成功！"),React.createElement("span",null,"请使用新密码登录"),React.createElement("a",{className:"sessions-submit",href:e+"login"},"去登录"))}},{key:"render",value:function(){var e=this.props,t=this.state;if(e.done)return this.renderDone();var a=e.user,s=a.get("captchaTime"),n=[];_.mapObject(t.warnText,function(e,t){e&&n.push(React.createElement("li",{key:t},e))});var r=s+"秒后可重新发送",o=t.couldSendCaptch?"":"disabled",c=this.renderTitle();return React.createElement("div",{className:"sessions-register"},c,React.createElement("form",{className:"sessions-form",onSubmit:this.submitForm.bind(this)},React.createElement("div",{className:"sessions-cellphone"},React.createElement("div",{className:"cellphone-code"},React.createElement("span",{className:"code-blk"},React.createElement(l["default"],{className:"code-select",onChose:this.handleGetCellphoneCode.bind(this)})),React.createElement("span",{className:"yicon-select-down select-down"})),React.createElement("input",{className:"form-input "+(t.warnText.cellphone?"warn":""),placeholder:"请输入您注册的手机号码",type:"telephone",name:"cellphone",maxLength:11,value:a.get("cellphone"),onChange:this.handleSetPhone.bind(this),onBlur:this.handleVerify.bind(this)})),React.createElement("div",{className:"sessions-captcha"},React.createElement("input",{className:"form-input "+(t.warnText.captcha?"warn":""),placeholder:"请输入验证码",type:"text",name:"captcha",maxLength:6,value:a.get("captcha"),autoComplete:"off",onChange:this.handleSetCaptcha.bind(this),onBlur:this.handleVerify.bind(this)}),React.createElement("div",{className:"input-text"},s>0?r:React.createElement("a",{href:"javascript:;",onClick:this.handleGetCaptcha.bind(this),className:"input-link "+o},"获取验证码"))),React.createElement("div",{className:"sessions-password"},React.createElement("input",{type:"text",style:{display:"none"}}),React.createElement("input",{className:"form-input "+(t.warnText.password?"warn":""),placeholder:"请设置至少6位密码",size:"30",type:"password",name:"password",value:a.get("password"),onChange:this.handleSetPassword.bind(this),onBlur:this.handleVerify.bind(this)})),React.createElement("ul",{className:"sessions-warn"},n),React.createElement("button",{className:"sessions-submit",type:"submit",disabled:!this.state.couldSubmit},e.isFindPassword?"重置密码":"注册")),React.createElement("div",{className:"sessions-other-link"},React.createElement("a",{href:"#global/weixinLogin",className:"pull-left"},"微信登录"),React.createElement("a",{href:"http://s.fishtrip.cn",className:"pull-right"},"我是供应商")))}},{key:"handleGetCellphoneCode",value:function(e){this.props.user.set("country_code",e)}},{key:"checkValue",value:function(){var e=this.props.user,t=e.check("cellphone").checked,a=e.check("password").checked,s=e.check("captcha").checked;this.setState({couldSendCaptch:t}),this.setState({couldSubmit:t&&a&&s})}},{key:"submitForm",value:function(e){e.preventDefault();var t=this;this.props.isFindPassword?this.props.user.resetPassword(function(){var e=t.props.global?"#global/":"#/";Backbone.history.navigate(e+"findPassword/done",{trigger:!0})},function(e,a){t.setState({warnText:{remote:a}})}):this.props.user.register(function(){},function(e,a){t.setState({warnText:{remote:a}})})}},{key:"handleVerify",value:function(e){var t=this.props.user.check(e.target.name),a={};a[e.target.name]=t.txt;var s=React.addons.update(this.state.warnText,{$merge:a});this.setState({warnText:s})}},{key:"handleSetPhone",value:function(e){this.props.user.set("cellphone",e.target.value)}},{key:"handleSetPassword",value:function(e){this.props.user.set("password",e.target.value)}},{key:"handleSetCaptcha",value:function(e){this.props.user.set("captcha",e.target.value)}},{key:"handleGetCaptcha",value:function(){if(!this.state.couldSendCaptch)return!1;var e=this.props.user;e.set("captchaTime",this.props.user.get("captchaInitTime"));var t=this;this.props.user.getSMSCode(function(a,s){e.set("captchaTime",0),t.setState({warnText:{remote:s}})})}},{key:"componentWillMount",value:function(){var e=this;this.props.user.on("change",function(){e.checkValue(),e.forceUpdate()},this)}},{key:"componentWillUnmount",value:function(){this.props.user.off("change")}},{key:"componentDidMount",value:function(){this.checkValue()}}]),t}(React.Component),p=function(e){function t(e){n(this,t),c(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.displayName="FindPassWord"}return r(t,e),t}(u);p.defaultProps={isFindPassword:!0},t["default"]={Register:u,FindPassWord:p},a.exports=t["default"]});
/*!module/fishui/mobile/dialog/dialog.js*/
;define("module/fishui/mobile/dialog/dialog",function(t,e,n){delete n.exports,this.jQuery=window.jQuery,this.$=window.$,!function(e,o){"use strict";if("undefined"!=typeof n&&n.exports){var i="undefined"!=typeof process,s=i&&"electron"in process.versions;s?e.BootstrapDialog=o(e.jQuery):n.exports=o(t("jquery"),t("bootstrap"))}else"function"==typeof define&&define.amd?define("bootstrap-dialog",["jquery","bootstrap"],function(t){return o(t)}):e.BootstrapDialog=o(e.jQuery)}(this,function(t){"use strict";var e=t.fn.modal.Constructor,n=function(t,n){e.call(this,t,n)};n.getModalVersion=function(){var e=null;return e="undefined"==typeof t.fn.modal.Constructor.VERSION?"v3.1":/3\.2\.\d+/.test(t.fn.modal.Constructor.VERSION)?"v3.2":/3\.3\.[1,2]/.test(t.fn.modal.Constructor.VERSION)?"v3.3":"v3.3.4"},n.ORIGINAL_BODY_PADDING=parseInt(t("body").css("padding-right")||0,10),n.METHODS_TO_OVERRIDE={},n.METHODS_TO_OVERRIDE["v3.1"]={},n.METHODS_TO_OVERRIDE["v3.2"]={hide:function(e){if(e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()){this.isShown=!1;var n=this.getGlobalOpenedDialogs();0===n.length&&this.$body.removeClass("modal-open"),this.resetScrollbar(),this.escape(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal()}}},n.METHODS_TO_OVERRIDE["v3.3"]={setScrollbar:function(){var t=n.ORIGINAL_BODY_PADDING;this.bodyIsOverflowing&&this.$body.css("padding-right",t+this.scrollbarWidth)},resetScrollbar:function(){var t=this.getGlobalOpenedDialogs();0===t.length&&this.$body.css("padding-right",n.ORIGINAL_BODY_PADDING)},hideModal:function(){this.$element.hide(),this.backdrop(t.proxy(function(){var t=this.getGlobalOpenedDialogs();0===t.length&&this.$body.removeClass("modal-open"),this.resetAdjustments(),this.resetScrollbar(),this.$element.trigger("hidden.bs.modal")},this))}},n.METHODS_TO_OVERRIDE["v3.3.4"]=t.extend({},n.METHODS_TO_OVERRIDE["v3.3"]),n.prototype={constructor:n,getGlobalOpenedDialogs:function(){var e=[];return t.each(o.dialogs,function(t,n){n.isRealized()&&n.isOpened()&&e.push(n)}),e}},n.prototype=t.extend(n.prototype,e.prototype,n.METHODS_TO_OVERRIDE[n.getModalVersion()]);var o=function(e){this.defaultOptions=t.extend(!0,{id:o.newGuid(),buttons:[],data:{},onshow:null,onshown:null,onhide:null,onhidden:null},o.defaultOptions),this.indexedButtons={},this.registeredButtonHotkeys={},this.draggableData={isMouseDown:!1,mouseOffset:{}},this.realized=!1,this.opened=!1,this.initOptions(e),this.holdThisInstance()};return o.BootstrapDialogModal=n,o.NAMESPACE="bootstrap-dialog",o.TYPE_DEFAULT="type-default",o.TYPE_INFO="type-info",o.TYPE_PRIMARY="type-primary",o.TYPE_SUCCESS="type-success",o.TYPE_WARNING="type-warning",o.TYPE_DANGER="type-danger",o.DEFAULT_TEXTS={},o.DEFAULT_TEXTS[o.TYPE_DEFAULT]="Information",o.DEFAULT_TEXTS[o.TYPE_INFO]="Information",o.DEFAULT_TEXTS[o.TYPE_PRIMARY]="Information",o.DEFAULT_TEXTS[o.TYPE_SUCCESS]="Success",o.DEFAULT_TEXTS[o.TYPE_WARNING]="Warning",o.DEFAULT_TEXTS[o.TYPE_DANGER]="Danger",o.DEFAULT_TEXTS.OK="OK",o.DEFAULT_TEXTS.CANCEL="Cancel",o.DEFAULT_TEXTS.CONFIRM="Confirmation",o.SIZE_NORMAL="size-normal",o.SIZE_SMALL="size-small",o.SIZE_WIDE="size-wide",o.SIZE_LARGE="size-large",o.BUTTON_SIZES={},o.BUTTON_SIZES[o.SIZE_NORMAL]="",o.BUTTON_SIZES[o.SIZE_SMALL]="",o.BUTTON_SIZES[o.SIZE_WIDE]="",o.BUTTON_SIZES[o.SIZE_LARGE]="btn-lg",o.ICON_SPINNER="glyphicon glyphicon-asterisk",o.defaultOptions={type:o.TYPE_PRIMARY,size:o.SIZE_NORMAL,cssClass:"",title:null,message:null,nl2br:!0,closable:!0,closeByBackdrop:!0,closeByKeyboard:!0,spinicon:o.ICON_SPINNER,autodestroy:!0,draggable:!1,animate:!0,description:"",tabindex:-1},o.configDefaultOptions=function(e){o.defaultOptions=t.extend(!0,o.defaultOptions,e)},o.dialogs={},o.openAll=function(){t.each(o.dialogs,function(t,e){e.open()})},o.closeAll=function(){t.each(o.dialogs,function(t,e){e.close()})},o.getDialog=function(t){var e=null;return"undefined"!=typeof o.dialogs[t]&&(e=o.dialogs[t]),e},o.setDialog=function(t){return o.dialogs[t.getId()]=t,t},o.addDialog=function(t){return o.setDialog(t)},o.moveFocus=function(){var e=null;t.each(o.dialogs,function(t,n){e=n}),null!==e&&e.isRealized()&&e.getModal().focus()},o.METHODS_TO_OVERRIDE={},o.METHODS_TO_OVERRIDE["v3.1"]={handleModalBackdropEvent:function(){return this.getModal().on("click",{dialog:this},function(t){t.target===this&&t.data.dialog.isClosable()&&t.data.dialog.canCloseByBackdrop()&&t.data.dialog.close()}),this},updateZIndex:function(){var e=1040,n=1050,i=0;t.each(o.dialogs,function(){i++});var s=this.getModal(),a=s.data("bs.modal").$backdrop;return s.css("z-index",n+20*(i-1)),a.css("z-index",e+20*(i-1)),this},open:function(){return!this.isRealized()&&this.realize(),this.getModal().modal("show"),this.updateZIndex(),this}},o.METHODS_TO_OVERRIDE["v3.2"]={handleModalBackdropEvent:o.METHODS_TO_OVERRIDE["v3.1"].handleModalBackdropEvent,updateZIndex:o.METHODS_TO_OVERRIDE["v3.1"].updateZIndex,open:o.METHODS_TO_OVERRIDE["v3.1"].open},o.METHODS_TO_OVERRIDE["v3.3"]={},o.METHODS_TO_OVERRIDE["v3.3.4"]=t.extend({},o.METHODS_TO_OVERRIDE["v3.1"]),o.prototype={constructor:o,initOptions:function(e){return this.options=t.extend(!0,this.defaultOptions,e),this},holdThisInstance:function(){return o.addDialog(this),this},initModalStuff:function(){return this.setModal(this.createModal()).setModalDialog(this.createModalDialog()).setModalContent(this.createModalContent()).setModalHeader(this.createModalHeader()).setModalBody(this.createModalBody()).setModalFooter(this.createModalFooter()),this.getModal().append(this.getModalDialog()),this.getModalDialog().append(this.getModalContent()),this.getModalContent().append(this.getModalHeader()).append(this.getModalBody()).append(this.getModalFooter()),this},createModal:function(){var e=t('<div class="modal" role="dialog" aria-hidden="true"></div>');return e.prop("id",this.getId()),e.attr("aria-labelledby",this.getId()+"_title"),e},getModal:function(){return this.$modal},setModal:function(t){return this.$modal=t,this},createModalDialog:function(){return t('<div class="modal-dialog"></div>')},getModalDialog:function(){return this.$modalDialog},setModalDialog:function(t){return this.$modalDialog=t,this},createModalContent:function(){return t('<div class="modal-content"></div>')},getModalContent:function(){return this.$modalContent},setModalContent:function(t){return this.$modalContent=t,this},createModalHeader:function(){return t('<div class="modal-header"></div>')},getModalHeader:function(){return this.$modalHeader},setModalHeader:function(t){return this.$modalHeader=t,this},createModalBody:function(){return t('<div class="modal-body"></div>')},getModalBody:function(){return this.$modalBody},setModalBody:function(t){return this.$modalBody=t,this},createModalFooter:function(){return t('<div class="modal-footer"></div>')},getModalFooter:function(){return this.$modalFooter},setModalFooter:function(t){return this.$modalFooter=t,this},createDynamicContent:function(t){var e=null;return e="function"==typeof t?t.call(t,this):t,"string"==typeof e&&(e=this.formatStringContent(e)),e},formatStringContent:function(t){return this.options.nl2br?t.replace(/\r\n/g,"<br />").replace(/[\r\n]/g,"<br />"):t},setData:function(t,e){return this.options.data[t]=e,this},getData:function(t){return this.options.data[t]},setId:function(t){return this.options.id=t,this},getId:function(){return this.options.id},getType:function(){return this.options.type},setType:function(t){return this.options.type=t,this.updateType(),this},updateType:function(){if(this.isRealized()){var t=[o.TYPE_DEFAULT,o.TYPE_INFO,o.TYPE_PRIMARY,o.TYPE_SUCCESS,o.TYPE_WARNING,o.TYPE_DANGER];this.getModal().removeClass(t.join(" ")).addClass(this.getType())}return this},getSize:function(){return this.options.size},setSize:function(t){return this.options.size=t,this.updateSize(),this},updateSize:function(){if(this.isRealized()){var e=this;this.getModal().removeClass(o.SIZE_NORMAL).removeClass(o.SIZE_SMALL).removeClass(o.SIZE_WIDE).removeClass(o.SIZE_LARGE),this.getModal().addClass(this.getSize()),this.getModalDialog().removeClass("modal-sm"),this.getSize()===o.SIZE_SMALL&&this.getModalDialog().addClass("modal-sm"),this.getModalDialog().removeClass("modal-lg"),this.getSize()===o.SIZE_WIDE&&this.getModalDialog().addClass("modal-lg"),t.each(this.options.buttons,function(n,o){var i=e.getButton(o.id),s=["btn-lg","btn-sm","btn-xs"],a=!1;if("string"==typeof o.cssClass){var d=o.cssClass.split(" ");t.each(d,function(e,n){-1!==t.inArray(n,s)&&(a=!0)})}a||(i.removeClass(s.join(" ")),i.addClass(e.getButtonSize()))})}return this},getCssClass:function(){return this.options.cssClass},setCssClass:function(t){return this.options.cssClass=t,this},getTitle:function(){return this.options.title},setTitle:function(t){return this.options.title=t,this.updateTitle(),this},updateTitle:function(){if(this.isRealized()){var t=null!==this.getTitle()?this.createDynamicContent(this.getTitle()):this.getDefaultText();this.getModalHeader().find("."+this.getNamespace("title")).html("").append(t).prop("id",this.getId()+"_title")}return this},getMessage:function(){return this.options.message},setMessage:function(t){return this.options.message=t,this.updateMessage(),this},updateMessage:function(){if(this.isRealized()){var t=this.createDynamicContent(this.getMessage());this.getModalBody().find("."+this.getNamespace("message")).html("").append(t)}return this},isClosable:function(){return this.options.closable},setClosable:function(t){return this.options.closable=t,this.updateClosable(),this},setCloseByBackdrop:function(t){return this.options.closeByBackdrop=t,this},canCloseByBackdrop:function(){return this.options.closeByBackdrop},setCloseByKeyboard:function(t){return this.options.closeByKeyboard=t,this},canCloseByKeyboard:function(){return this.options.closeByKeyboard},isAnimate:function(){return this.options.animate},setAnimate:function(t){return this.options.animate=t,this},updateAnimate:function(){return this.isRealized()&&this.getModal().toggleClass("fade",this.isAnimate()),this},getSpinicon:function(){return this.options.spinicon},setSpinicon:function(t){return this.options.spinicon=t,this},addButton:function(t){return this.options.buttons.push(t),this},addButtons:function(e){var n=this;return t.each(e,function(t,e){n.addButton(e)}),this},getButtons:function(){return this.options.buttons},setButtons:function(t){return this.options.buttons=t,this.updateButtons(),this},getButton:function(t){return"undefined"!=typeof this.indexedButtons[t]?this.indexedButtons[t]:null},getButtonSize:function(){return"undefined"!=typeof o.BUTTON_SIZES[this.getSize()]?o.BUTTON_SIZES[this.getSize()]:""},updateButtons:function(){return this.isRealized()&&(0===this.getButtons().length?this.getModalFooter().hide():this.getModalFooter().show().find("."+this.getNamespace("footer")).html("").append(this.createFooterButtons())),this},isAutodestroy:function(){return this.options.autodestroy},setAutodestroy:function(t){this.options.autodestroy=t},getDescription:function(){return this.options.description},setDescription:function(t){return this.options.description=t,this},setTabindex:function(t){return this.options.tabindex=t,this},getTabindex:function(){return this.options.tabindex},updateTabindex:function(){return this.isRealized()&&this.getModal().attr("tabindex",this.getTabindex()),this},getDefaultText:function(){return o.DEFAULT_TEXTS[this.getType()]},getNamespace:function(t){return o.NAMESPACE+"-"+t},createHeaderContent:function(){var e=t("<div></div>");return e.addClass(this.getNamespace("header")),e.append(this.createTitleContent()),e.prepend(this.createCloseButton()),e},createTitleContent:function(){var e=t("<div></div>");return e.addClass(this.getNamespace("title")),e},createCloseButton:function(){var e=t("<div></div>");e.addClass(this.getNamespace("close-button"));var n=t('<button class="close">&times;</button>');return e.append(n),e.on("click",{dialog:this},function(t){t.data.dialog.close()}),e},createBodyContent:function(){var e=t("<div></div>");return e.addClass(this.getNamespace("body")),e.append(this.createMessageContent()),e},createMessageContent:function(){var e=t("<div></div>");return e.addClass(this.getNamespace("message")),e},createFooterContent:function(){var e=t("<div></div>");return e.addClass(this.getNamespace("footer")),e},createFooterButtons:function(){var e=this,n=t("<div></div>");return n.addClass(this.getNamespace("footer-buttons")),this.indexedButtons={},t.each(this.options.buttons,function(t,i){i.id||(i.id=o.newGuid());var s=e.createButton(i);e.indexedButtons[i.id]=s,n.append(s)}),n},createButton:function(e){var n=t('<button class="btn"></button>');return n.prop("id",e.id),n.data("button",e),"undefined"!=typeof e.icon&&""!==t.trim(e.icon)&&n.append(this.createButtonIcon(e.icon)),"undefined"!=typeof e.label&&n.append(e.label),n.addClass("undefined"!=typeof e.cssClass&&""!==t.trim(e.cssClass)?e.cssClass:"btn-default"),"undefined"!=typeof e.hotkey&&(this.registeredButtonHotkeys[e.hotkey]=n),n.on("click",{dialog:this,$button:n,button:e},function(t){var e=t.data.dialog,n=t.data.$button,o=n.data("button");"function"==typeof o.action&&o.action.call(n,e,t),o.autospin&&n.toggleSpin(!0)}),this.enhanceButton(n),"undefined"!=typeof e.enabled&&n.toggleEnable(e.enabled),n},enhanceButton:function(t){return t.dialog=this,t.toggleEnable=function(t){var e=this;return"undefined"!=typeof t?e.prop("disabled",!t).toggleClass("disabled",!t):e.prop("disabled",!e.prop("disabled")),e},t.enable=function(){var t=this;return t.toggleEnable(!0),t},t.disable=function(){var t=this;return t.toggleEnable(!1),t},t.toggleSpin=function(e){var n=this,o=n.dialog,i=n.find("."+o.getNamespace("button-icon"));return"undefined"==typeof e&&(e=!(t.find(".icon-spin").length>0)),e?(i.hide(),t.prepend(o.createButtonIcon(o.getSpinicon()).addClass("icon-spin"))):(i.show(),t.find(".icon-spin").remove()),n},t.spin=function(){var t=this;return t.toggleSpin(!0),t},t.stopSpin=function(){var t=this;return t.toggleSpin(!1),t},this},createButtonIcon:function(e){var n=t("<span></span>");return n.addClass(this.getNamespace("button-icon")).addClass(e),n},enableButtons:function(e){return t.each(this.indexedButtons,function(t,n){n.toggleEnable(e)}),this},updateClosable:function(){return this.isRealized()&&this.getModalHeader().find("."+this.getNamespace("close-button")).toggle(this.isClosable()),this},onShow:function(t){return this.options.onshow=t,this},onShown:function(t){return this.options.onshown=t,this},onHide:function(t){return this.options.onhide=t,this},onHidden:function(t){return this.options.onhidden=t,this},isRealized:function(){return this.realized},setRealized:function(t){return this.realized=t,this},isOpened:function(){return this.opened},setOpened:function(t){return this.opened=t,this},handleModalEvents:function(){return this.getModal().on("show.bs.modal",{dialog:this},function(t){var e=t.data.dialog;if(e.setOpened(!0),e.isModalEvent(t)&&"function"==typeof e.options.onshow){var n=e.options.onshow(e);return n===!1&&e.setOpened(!1),n}}),this.getModal().on("shown.bs.modal",{dialog:this},function(t){var e=t.data.dialog;e.isModalEvent(t)&&"function"==typeof e.options.onshown&&e.options.onshown(e)}),this.getModal().on("hide.bs.modal",{dialog:this},function(t){var e=t.data.dialog;if(e.setOpened(!1),e.isModalEvent(t)&&"function"==typeof e.options.onhide){var n=e.options.onhide(e);return n===!1&&e.setOpened(!0),n}}),this.getModal().on("hidden.bs.modal",{dialog:this},function(e){var n=e.data.dialog;n.isModalEvent(e)&&"function"==typeof n.options.onhidden&&n.options.onhidden(n),n.isAutodestroy()&&(delete o.dialogs[n.getId()],t(this).remove()),o.moveFocus()}),this.handleModalBackdropEvent(),this.getModal().on("keyup",{dialog:this},function(t){27===t.which&&t.data.dialog.isClosable()&&t.data.dialog.canCloseByKeyboard()&&t.data.dialog.close()}),this.getModal().on("keyup",{dialog:this},function(e){var n=e.data.dialog;if("undefined"!=typeof n.registeredButtonHotkeys[e.which]){var o=t(n.registeredButtonHotkeys[e.which]);!o.prop("disabled")&&o.focus().trigger("click")}}),this},handleModalBackdropEvent:function(){return this.getModal().on("click",{dialog:this},function(e){t(e.target).hasClass("modal-backdrop")&&e.data.dialog.isClosable()&&e.data.dialog.canCloseByBackdrop()&&e.data.dialog.close()}),this},isModalEvent:function(t){return"undefined"!=typeof t.namespace&&"bs.modal"===t.namespace},makeModalDraggable:function(){return this.options.draggable&&(this.getModalHeader().addClass(this.getNamespace("draggable")).on("mousedown",{dialog:this},function(t){var e=t.data.dialog;e.draggableData.isMouseDown=!0;var n=e.getModalDialog().offset();e.draggableData.mouseOffset={top:t.clientY-n.top,left:t.clientX-n.left}}),this.getModal().on("mouseup mouseleave",{dialog:this},function(t){t.data.dialog.draggableData.isMouseDown=!1}),t("body").on("mousemove",{dialog:this},function(t){var e=t.data.dialog;e.draggableData.isMouseDown&&e.getModalDialog().offset({top:t.clientY-e.draggableData.mouseOffset.top,left:t.clientX-e.draggableData.mouseOffset.left})})),this},realize:function(){return this.initModalStuff(),this.getModal().addClass(o.NAMESPACE).addClass(this.getCssClass()),this.updateSize(),this.getDescription()&&this.getModal().attr("aria-describedby",this.getDescription()),this.getModalFooter().append(this.createFooterContent()),this.getModalHeader().append(this.createHeaderContent()),this.getModalBody().append(this.createBodyContent()),this.getModal().data("bs.modal",new n(this.getModal(),{backdrop:"static",keyboard:!1,show:!1})),this.makeModalDraggable(),this.handleModalEvents(),this.setRealized(!0),this.updateButtons(),this.updateType(),this.updateTitle(),this.updateMessage(),this.updateClosable(),this.updateAnimate(),this.updateSize(),this.updateTabindex(),this},open:function(){return!this.isRealized()&&this.realize(),this.getModal().modal("show"),this},close:function(){return!this.isRealized()&&this.realize(),this.getModal().modal("hide"),this}},o.prototype=t.extend(o.prototype,o.METHODS_TO_OVERRIDE[n.getModalVersion()]),o.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"===t?e:3&e|8;return n.toString(16)})},o.show=function(t){return new o(t).open()},o.alert=function(){var e={},n={type:o.TYPE_PRIMARY,title:null,message:null,closable:!1,draggable:!1,buttonLabel:o.DEFAULT_TEXTS.OK,callback:null};return e="object"==typeof arguments[0]&&arguments[0].constructor==={}.constructor?t.extend(!0,n,arguments[0]):t.extend(!0,n,{message:arguments[0],callback:"undefined"!=typeof arguments[1]?arguments[1]:null}),new o({type:e.type,title:e.title,message:e.message,closable:e.closable,draggable:e.draggable,data:{callback:e.callback},onhide:function(t){!t.getData("btnClicked")&&t.isClosable()&&"function"==typeof t.getData("callback")&&t.getData("callback")(!1)},buttons:[{label:e.buttonLabel,action:function(t){t.setData("btnClicked",!0),"function"==typeof t.getData("callback")&&t.getData("callback")(!0),t.close()}}]}).open()},o.confirm=function(){var e={},n={type:o.TYPE_PRIMARY,title:null,message:null,closable:!1,draggable:!1,btnCancelLabel:o.DEFAULT_TEXTS.CANCEL,btnOKLabel:o.DEFAULT_TEXTS.OK,btnOKClass:null,callback:null};return e="object"==typeof arguments[0]&&arguments[0].constructor==={}.constructor?t.extend(!0,n,arguments[0]):t.extend(!0,n,{message:arguments[0],closable:!1,buttonLabel:o.DEFAULT_TEXTS.OK,callback:"undefined"!=typeof arguments[1]?arguments[1]:null}),null===e.btnOKClass&&(e.btnOKClass=["btn",e.type.split("-")[1]].join("-")),new o({type:e.type,title:e.title,message:e.message,closable:e.closable,draggable:e.draggable,data:{callback:e.callback},buttons:[{label:e.btnCancelLabel,action:function(t){"function"==typeof t.getData("callback")&&t.getData("callback")(!1),t.close()}},{label:e.btnOKLabel,cssClass:e.btnOKClass,action:function(t){"function"==typeof t.getData("callback")&&t.getData("callback")(!0),t.close()}}]}).open()},o.warning=function(t){return new o({type:o.TYPE_WARNING,message:t}).open()},o.danger=function(t){return new o({type:o.TYPE_DANGER,message:t}).open()},o.success=function(t){return new o({type:o.TYPE_SUCCESS,message:t}).open()},o}),n.exports=this.BootstrapDialog});
/*!components/sessions/sessions.jsx*/
;define("components/sessions/sessions.jsx",function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=function(e,t,o){for(var n=!0;n;){var s=e,i=t,r=o;n=!1,null===s&&(s=Function.prototype);var a=Object.getOwnPropertyDescriptor(s,i);if(void 0!==a){if("value"in a)return a.value;var c=a.get;return void 0===c?void 0:c.call(r)}var u=Object.getPrototypeOf(s);if(null===u)return void 0;e=u,t=i,o=r,n=!0,a=u=void 0}},c=e("components/sessions/login.jsx"),u=e("components/sessions/register.jsx"),l=e("module/fishui/mobile/dialog/dialog"),d=n(l),p=e("module/util/util"),h=n(p),f=function(e){function t(){s(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return i(t,e),r(t,[{key:"defaults",value:function(){return{country_code_name:"中国大陆 +86",country_code:"0086",cellphone:"",password:"",captcha:"",captchaPass:!1,captchaInitTime:30,captchaTime:0,remember_me:1}}},{key:"check",value:function(e){var t=h["default"].verify,o=this.attributes,n=Boolean("0086"==o.country_code),s=!1,i="";switch(e){case"cellphone":n&&t.checkChinaPhone(o.cellphone)||!n&&t.checkPhone(o.cellphone)?s=!0:i="手机号码无效";break;case"password":t.checkPassword(o.password)?s=!0:i="密码至少6位";break;case"captcha":t.checkCaptcha(o.captcha)?s=!0:i="请输入6位数字验证码";break;default:s=!1,i=""}return{checked:s,txt:i}}},{key:"_tick",value:function(){var e=this.get("captchaTime");e>0?this.set({captchaTime:e-1}):this.interval.clearInterval}},{key:"countDown",value:function(){0==this.get("captchaTime")&&this.set("captchaTime",this.get("captchaInitTime")),this.interval||(this.interval=setInterval(this._tick.bind(this),1e3))}},{key:"login",value:function(e){var t=this.attributes;$.ajax({url:"http://api.fishtrip.cn/api/v2/users/login",type:"POST",data:JSON.stringify({country_code:t.country_code,cellphone:t.cellphone,password:t.password,remember_me:t.remember_me}),beforeSend:function(){fishui.loading.show()},dataType:"json",contentType:"application/json",success:function(e){var o=h["default"].getQueryString("redirect")||location.href.split("#")[0],n={access_token:e.token,remember_me:t.remember_me};location.href=h["default"].updateQueryStringParameter(o,n)},error:function(t){var o="账号密码错误";_.isFunction(e)?e(t,o):alert(o)},complete:function(){fishui.loading.hide()}})}},{key:"resetPassword",value:function(e,t){return this.register(e,t,!0)}},{key:"register",value:function(e,t,o){var n=this.attributes;$.ajax({url:o?"http://api.fishtrip.cn/api/v2/users/reset_password":"http://api.fishtrip.cn/api/v2/users/sign_up",type:"POST",data:JSON.stringify({country_code:n.country_code,cellphone:n.cellphone,password:n.password,sms_code:n.captcha}),dataType:"json",contentType:"application/json",beforeSend:function(){fishui.loading.show()},success:function(t){if(!o){var n=location.href.split("#")[0],s={access_token:t.token};location.href=h["default"].updateQueryStringParameter(n,s)}_.isFunction(e)&&e(t)},error:function(e){var n="验证码错误";400!=e.status||o||(n="此手机号已存在"),400==e.status&&o&&(n="手机号未注册"),_.isFunction(t)&&t(e,n)},complete:function(){fishui.loading.hide()}})}},{key:"isExist",value:function o(){var e=this.attributes,o=!1;return $.ajax({url:"http://api.fishtrip.cn/api/v2/users/is_exist",type:"GET",async:!1,data:JSON.stringify({country_code:e.country_code,cellphone:e.cellphone}),dataType:"json",contentType:"application/json",beforeSend:function(){fishui.loading.show()},success:function(e){o=e.message},error:function(){},complete:function(){fishui.loading.hide()}}),o}},{key:"getSMSCode",value:function(e){var t=this.attributes,o=this,n=h["default"].encry({country_code:t.country_code,cellphone:t.cellphone});$.ajax({url:"http://api.fishtrip.cn/api/v2/users/send_sms_code",type:"POST",data:JSON.stringify(n),dataType:"json",contentType:"application/json",beforeSend:function(){fishui.loading.show()},success:function(){o.countDown()},error:function(t){_.isFunction(e)?e(t,"验证码获取失败，请重试"):alert("验证码获取失败，请重试")},complete:function(){fishui.loading.hide()}})}}]),t}(Backbone.Model),m=new f,y=function(e){function t(e){s(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,{routes:{"global/login":"login","global/register":"register","global/findPassword":"findPassword","global/findPassword/:done":"findPassword","global/weixinLogin":"weixinLogin"}}),this.Sessions=e}return i(t,e),r(t,[{key:"initModal",value:function(){$(".sessions-modal").length?$(".sessions-modal").modal("show"):($(".modal").modal("hide"),$("#react-sessions-modal").show(),d["default"].show({type:d["default"].TYPE_DEFAULT,cssClass:"sessions-modal",message:$("#react-sessions-modal"),autodestroy:!1,onhide:function(){location.hash="",m.set({password:"",captcha:""})}}))}},{key:"login",value:function(){_.defer(this.initModal),ReactDOM.render(React.createElement(c.Login,{user:this.Sessions.props.user,global:!0}),document.getElementById("sessions-modal-root"))}},{key:"register",value:function(){_.defer(this.initModal),ReactDOM.render(React.createElement(u.Register,{user:this.Sessions.props.user,global:!0}),document.getElementById("sessions-modal-root"))}},{key:"findPassword",value:function(e){_.defer(this.initModal),ReactDOM.render(React.createElement(u.FindPassWord,{user:this.Sessions.props.user,done:Boolean(e),global:!0}),document.getElementById("sessions-modal-root"))}},{key:"weixinLogin",value:function(){_.defer(this.initModal),ReactDOM.render(React.createElement(c.WeixinLogin,null),document.getElementById("sessions-modal-root"))}}]),t}(Backbone.Router),g=function(e){function t(e){s(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,{routes:{"":"login",login:"login",register:"register",findPassword:"findPassword","findPassword/:done":"findPassword"}}),this.Sessions=e}return i(t,e),r(t,[{key:"login",value:function(){ReactDOM.render(React.createElement(c.Login,{user:this.Sessions.props.user}),document.getElementById("sessions-root"))}},{key:"register",value:function(){ReactDOM.render(React.createElement(u.Register,{user:this.Sessions.props.user}),document.getElementById("sessions-root"))}},{key:"findPassword",value:function(e){ReactDOM.render(React.createElement(u.FindPassWord,{user:this.Sessions.props.user,done:Boolean(e)}),document.getElementById("sessions-root"))}}]),t}(Backbone.Router),v=function(e){function t(e){s(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.displayName="SessionsModal",this.state={show:"login"}}return i(t,e),r(t,[{key:"render",value:function(){this.props,this.state;return React.createElement("div",{className:"react-sessions react-sessions-modal",id:"sessions-modal-root"})}},{key:"componentDidMount",value:function(){new y(this)}}]),t}(React.Component),b=function(e){function t(e){s(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.displayName="Sessions",this.state={show:"register"}}return i(t,e),r(t,[{key:"render",value:function(){this.props,this.state;return React.createElement("div",{className:"react-sessions",id:"sessions-root"})}},{key:"changShow",value:function(e){this.setState({show:e.target.dataset.show})}},{key:"componentDidMount",value:function(){new g(this)}}]),t}(React.Component);t["default"]={initModal:function(){$("#react-sessions-modal").length||($("body").append($("<div id='react-sessions-modal' style='display: none'></div>")),ReactDOM.render(React.createElement(v,{user:m}),$("#react-sessions-modal")[0]))},initSessions:function(e){var e=e||document.getElementById("react-root");ReactDOM.render(React.createElement(b,{user:m}),e)}},o.exports=t["default"]});
/*!js/pc/common.js*/
;"use strict";var app=app||{};app.sessions=require("components/sessions/sessions.jsx"),app.sessions.initModal(),$(function(){Backbone.history.start()});
